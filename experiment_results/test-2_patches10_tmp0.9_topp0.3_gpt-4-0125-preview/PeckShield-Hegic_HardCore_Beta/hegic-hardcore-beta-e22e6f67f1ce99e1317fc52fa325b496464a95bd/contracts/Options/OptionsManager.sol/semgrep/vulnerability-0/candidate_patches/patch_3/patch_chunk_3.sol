function _safeTransfer(address from, address to, uint256 tokenId, bytes memory data) internal virtual {
    address owner = _ownerOf(tokenId);
    require(owner == from, "ERC721: transfer from incorrect owner");
    require(to != address(0), "ERC721: transfer to the zero address");

    _beforeTokenTransfer(from, to, tokenId, 1);

    // Clear approvals from the previous owner
    _approve(address(0), tokenId);

    unchecked {
        _balances[from] -= 1;
        _balances[to] += 1;
    }

    _owners[tokenId] = to;

    emit Transfer(from, to, tokenId);

    _afterTokenTransfer(from, to, tokenId, 1);

    require(_checkOnERC721Received(from, to, tokenId, data), "ERC721: transfer to non ERC721Receiver implementer");
}