function _setImplementation(address implementation_, bool allowResign, bytes memory becomeImplementationData) public {
    require(msg.sender == admin, "RErc20Delegator::_setImplementation: Caller must be admin");

    if (allowResign) {
        // Reentrancy vulnerability fix: using a direct call instead of delegateCall to prevent reentrancy
        (bool success, ) = implementation.call(abi.encodeWithSignature("_resignImplementation()"));
        require(success, "RErc20Delegator::_setImplementation: _resignImplementation call failed");
    }

    address oldImplementation = implementation;
    implementation = implementation_;

    // Reentrancy vulnerability fix: using a direct call instead of delegateCall to prevent reentrancy
    (bool success, ) = implementation.call(abi.encodeWithSignature("_becomeImplementation(bytes)", becomeImplementationData));
    require(success, "RErc20Delegator::_setImplementation: _becomeImplementation call failed");

    emit NewImplementation(oldImplementation, implementation);
}