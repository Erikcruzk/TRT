function withdraw(uint256 amount)
        public
        nonReentrant
        updateReward(msg.sender)
    {
        require(amount > 0);
        uint256 balanceBefore = CDEXToken.balanceOf(address(this));
        
        _totalSupply = _totalSupply.sub(amount);
        
        CDEXRanking.remove(_balances[msg.sender], msg.sender);
        
        _balances[msg.sender] = _balances[msg.sender].sub(amount);
        
        if(_balances[msg.sender] == 0) {
            totalMembers -= 1;
        } else {
            CDEXRanking.insert(_balances[msg.sender], msg.sender);
        }
        
        CDEXToken.transfer(msg.sender, amount);

        uint256 balanceAfter = CDEXToken.balanceOf(address(this));
        require(balanceBefore.sub(balanceAfter) == amount, "Invalid transfer");

        emit Withdrawn(msg.sender, amount);
    }