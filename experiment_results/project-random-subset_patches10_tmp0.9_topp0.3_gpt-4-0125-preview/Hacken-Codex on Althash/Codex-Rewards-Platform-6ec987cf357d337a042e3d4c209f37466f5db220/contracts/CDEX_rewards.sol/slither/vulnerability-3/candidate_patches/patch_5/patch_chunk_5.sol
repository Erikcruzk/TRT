function withdraw(uint256 amount)
    public
    nonReentrant
    updateReward(msg.sender)
{
    require(amount > 0);

    _totalSupply = _totalSupply.sub(amount);

    /// Decrements the sender's staked balance
    uint256 userBalanceBefore = _balances[msg.sender];
    _balances[msg.sender] = _balances[msg.sender].sub(amount);

    /// If the balance is zero after decremented, decrements the totalMembers
    if(_balances[msg.sender] == 0) {
        totalMembers -= 1;
    } 
    
    /// Transfers the tokens into the sender's address
    CDEXToken.transfer(msg.sender, amount);
    
    if(userBalanceBefore == amount) {
        /// Removes the user address from its current ranking node in the tree IF the whole balance is withdrawn
        CDEXRanking.remove(userBalanceBefore, msg.sender);
    } else {
        /// Removes and then adds the user address back into the ranking tree with the new balance to update the ranking
        CDEXRanking.remove(userBalanceBefore, msg.sender);
        CDEXRanking.insert(_balances[msg.sender], msg.sender);
    }

    /// Emits the event
    emit Withdrawn(msg.sender, amount);
}