function releaseTokens() public {
    uint256 releaseCount = 0;
    uint256 totalAmount = 0;
    require(walletTokens[msg.sender].length > 0);

    for(uint256 i = 0; i < walletTokens[msg.sender].length; i++) {
        if(!walletTokens[msg.sender][i].released && now >= walletTokens[msg.sender][i].lockEndTime) {
            walletTokens[msg.sender][i].released = true;
            totalAmount = safeAdd(totalAmount, walletTokens[msg.sender][i].amount);
            releaseCount++;
        }
    }
    if (releaseCount > 0) {
        token.transfer(msg.sender, totalAmount);
        TokensUnlocked(msg.sender, totalAmount);
    }
}