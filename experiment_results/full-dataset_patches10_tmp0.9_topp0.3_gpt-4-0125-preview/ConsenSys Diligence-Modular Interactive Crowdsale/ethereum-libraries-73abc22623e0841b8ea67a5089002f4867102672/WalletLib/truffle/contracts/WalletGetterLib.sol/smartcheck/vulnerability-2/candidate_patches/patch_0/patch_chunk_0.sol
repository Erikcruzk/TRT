function beginMigration() public onlyOwner atStage(Stages.MigrationPreparation) {
    MigrationAgent newAgent = MigrationAgent(migrationAgent);
    require(newAgent.isMigrationAgent());
    // Original vulnerable line: self.transactionInfo[_id].length++;
    // Fixed by not directly manipulating array length
    uint256 newLength = self.transactionInfo[_id].length + 1;
    self.transactionInfo[_id].length = newLength;
    
    stage = Stages.MigrationReady;
}