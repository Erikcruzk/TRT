function uniq(uint256[] storage self) public returns (uint256 length) {
  for (uint256 i = 0; i < self.length; i++) {
    bool contains;
    uint256 index;

    (contains, index) = indexOf(self, self[i], false);
    if (i > index) {
      // Shift all elements to the left to fill the gap
      for (uint256 j = i; j < self.length - 1; j++) {
        self[j] = self[j + 1];
      }
      // Explicitly delete the last element
      delete self[self.length - 1];
      // Reduce the length of the array
      self.length -= 1;
      i--;
    }
  }
  length = self.length;
}