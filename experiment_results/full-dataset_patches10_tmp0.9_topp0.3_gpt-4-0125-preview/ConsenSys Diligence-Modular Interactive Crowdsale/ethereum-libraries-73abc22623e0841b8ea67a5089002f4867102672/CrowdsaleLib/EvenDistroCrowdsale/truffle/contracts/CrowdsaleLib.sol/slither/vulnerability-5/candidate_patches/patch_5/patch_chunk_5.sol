function setTokens(CrowdsaleStorage storage self) public returns (bool) {
    require(msg.sender == self.owner, "Only the owner can set tokens.");
    require(!self.tokensSet, "Tokens have already been set.");
    require(now < self.endTime, "Cannot set tokens after end time.");

    uint256 _tokenBalance = self.token.balanceOf(this);
    self.withdrawTokensMap[msg.sender] = _tokenBalance;
    self.startingTokenBalance = _tokenBalance;
    self.tokensSet = true;

    return true;
}