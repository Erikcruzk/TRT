function beginMigration(CrowdsaleStorage storage self) public returns (bool) {
    require(msg.sender == self.owner);
    require(!self.tokensSet); // Make sure tokens have not been set yet
    require(now > self.endTime); // Only allow after the end time of the sale

    uint256 _tokenBalance = self.token.balanceOf(this);
    self.withdrawTokensMap[msg.sender] = _tokenBalance; // Assign all remaining tokens to the owner for migration
    self.startingTokenBalance = 0; // Effectively ends the sale by setting starting balance to 0
    self.tokensSet = true; // Prevents re-entry or attempts to set tokens again

    return true;
}