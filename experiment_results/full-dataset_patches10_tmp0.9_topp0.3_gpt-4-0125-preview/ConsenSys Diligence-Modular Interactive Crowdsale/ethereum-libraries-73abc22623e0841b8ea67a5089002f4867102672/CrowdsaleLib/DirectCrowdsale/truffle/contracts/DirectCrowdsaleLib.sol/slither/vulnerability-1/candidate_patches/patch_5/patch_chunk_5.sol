function setTokens(DirectCrowdsaleStorage storage self) public returns (bool) {
    require(msg.sender == self.base.owner);
    require(!self.base.tokensSet);
    require(now < self.base.endTime);

    uint256 _tokenBalance = 0; // Initialized to avoid the uninitialized-local vulnerability

    _tokenBalance = self.base.token.balanceOf(this);
    self.base.withdrawTokensMap[msg.sender] = _tokenBalance;
    self.base.startingTokenBalance = _tokenBalance;
    self.base.tokensSet = true;

    return true;
}