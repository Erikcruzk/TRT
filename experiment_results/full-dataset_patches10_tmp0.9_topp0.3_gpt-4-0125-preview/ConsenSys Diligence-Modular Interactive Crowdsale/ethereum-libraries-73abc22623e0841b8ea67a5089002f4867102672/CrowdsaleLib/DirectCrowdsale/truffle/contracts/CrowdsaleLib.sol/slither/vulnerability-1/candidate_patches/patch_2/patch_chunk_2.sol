function beginMigration() public {
    uint256 index = 0; // Fixed uninitialized local variable
    require(msg.sender == owner);
    require(migrationAgent != 0);
    require(index < allocations.length);
    while (index < allocations.length && gasleft() > 400000) {
        address investor = allocations[index].holder;
        uint256 amount = allocations[index].value;
        allocations[index].value = 0;
        totalAllocated = totalAllocated.sub(amount);
        IMigrationAgent(migrationAgent).migrateFrom(investor, amount);
        index++;
    }
    migrationInitiated = true;
    if (index >= allocations.length) {
        migrationCompleted = true;
    }
}