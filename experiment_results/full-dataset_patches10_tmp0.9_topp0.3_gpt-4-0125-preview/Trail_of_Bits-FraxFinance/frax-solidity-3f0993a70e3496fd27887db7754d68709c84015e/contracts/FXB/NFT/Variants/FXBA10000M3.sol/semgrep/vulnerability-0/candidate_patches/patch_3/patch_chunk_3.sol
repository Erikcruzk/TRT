function _safeTransfer(address from, address to, uint256 tokenId, bytes memory _data) internal virtual {
    address ownerBeforeTransfer = ownerOf(tokenId);
    _transfer(from, to, tokenId);
    require(ownerBeforeTransfer == ownerOf(tokenId), "Reentrancy detected in _safeTransfer");
    require(_checkOnERC721Received(from, to, tokenId, _data), "ERC721: transfer to non ERC721Receiver implementer");
}