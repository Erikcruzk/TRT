function fairShare(uint256 balance, uint256 shares, uint256 totalShares) internal pure returns (uint256) {
    require(totalShares != 0);

    if (balance == 0) { return 0; }

    // Fix applied here: Changed the calculation to use SafeMath for division followed by multiplication to prevent rounding errors leading to loss of precision.
    return balance.mul(shares).div(totalShares);
}