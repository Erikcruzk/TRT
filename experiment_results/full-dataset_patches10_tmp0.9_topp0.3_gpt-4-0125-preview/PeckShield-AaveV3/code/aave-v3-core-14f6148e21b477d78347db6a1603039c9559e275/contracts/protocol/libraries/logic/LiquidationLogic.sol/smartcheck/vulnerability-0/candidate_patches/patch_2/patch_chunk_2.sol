function beginMigration(address _newProvider) external onlyOwnerOrPoolAdmin {
    address[] memory reserves = _getReservesList();
    for (uint256 i = 0; i < reserves.length; i++) {
        address reserve = reserves[i];
        DataTypes.ReserveData storage reserveData = _reserves[reserve];

        address aTokenAddress = reserveData.aTokenAddress;
        uint256 liquidityIndex = reserveData.liquidityIndex;
        uint256 variableDebtIndex = reserveData.variableBorrowIndex;

        // Ensure the new contract executes the code with the same storage layout
        ITokenConfiguration(newProvider).updateATokenImplementations(
            reserve,
            aTokenAddress,
            liquidityIndex,
            variableDebtIndex
        );
    }
    _addressesProvider = _newProvider;
    emit MigrationStarted(_newProvider);
}