function getPage(
        AddressSet storage set,
        uint startIndex,
        uint pageSize
    ) internal view returns (address[] memory) {
        
        uint endIndex = startIndex + pageSize; 

        
        if (endIndex > set.elements.length) {
            endIndex = set.elements.length;
        }
        if (endIndex <= startIndex) {
            return new address[](0);
        }

        uint n = endIndex - startIndex; 
        address[] memory page = new address[](n);
        for (uint i; i < n; i++) {
            page[i] = set.elements[i + startIndex];
        }
        return page;
    }