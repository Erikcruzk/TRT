function getPage(
    Bytes32Set storage set,
    uint pageIndex,
    uint pageSize
) internal view returns (bytes32[] memory) {
    
    uint endIndex = pageIndex + pageSize; 

    
    if (endIndex > set.elements.length) {
        endIndex = set.elements.length;
    }
    if (endIndex <= pageIndex) {
        return new bytes32[](0);
    }

    uint n = endIndex - pageIndex; 
    bytes32[] memory page = new bytes32[](n);
    for (uint i; i < n; i++) {
        page[i] = set.elements[i + pageIndex];
    }
    return page;
}