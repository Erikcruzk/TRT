function safeApprove(
    IERC20 token,
    address spender,
    uint256 value
) internal {
    // First reset the allowance to zero to mitigate the ERC20 approve race condition vulnerability
    _callOptionalReturn(
        token,
        abi.encodeWithSelector(token.approve.selector, spender, 0)
    );
    // Then set the desired allowance
    _callOptionalReturn(
        token,
        abi.encodeWithSelector(token.approve.selector, spender, value)
    );
}