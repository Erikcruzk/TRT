function safeApprove(
    IERC20 token,
    address spender,
    uint256 value
) internal {
    // This is a mitigation for a known ERC20 approve race condition
    // See: https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729
    uint256 currentAllowance = token.allowance(address(this), spender);
    if (currentAllowance > 0) {
        _callOptionalReturn(
            token,
            abi.encodeWithSelector(token.approve.selector, spender, 0)
        );
    }
    _callOptionalReturn(
        token,
        abi.encodeWithSelector(token.approve.selector, spender, value)
    );
}