function beginMigration(
    ExchangeData calldata exchangeData,
    CdpData memory cdpData,
    AddressRegistry calldata addressRegistry
  ) public {
    cdpData.ilk = IJoin(cdpData.gemJoin).ilk();
    address urn = IManager(addressRegistry.manager).urns(cdpData.cdpId);
    address vat = IManager(addressRegistry.manager).vat();

    uint256 ink = getInk(addressRegistry.manager, cdpData);
    uint256 art = _getWipeAllWad(vat, urn, urn, cdpData.ilk);
    cdpData.requiredDebt = art;

    bytes memory paramsData = abi.encode(2, exchangeData, cdpData, addressRegistry);

    takeAFlashLoan(addressRegistry, cdpData, paramsData);
  }