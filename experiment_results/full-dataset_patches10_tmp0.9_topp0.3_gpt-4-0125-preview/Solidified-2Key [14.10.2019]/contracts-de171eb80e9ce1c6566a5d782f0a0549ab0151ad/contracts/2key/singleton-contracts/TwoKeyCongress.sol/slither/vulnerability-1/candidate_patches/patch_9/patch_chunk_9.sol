function vote(
    uint proposalNumber,
    bool supportsProposal,
    string justificationText)
public
onlyMembers
returns (uint256 voteID)
{
    Proposal storage p = proposals[proposalNumber]; 
    require(now <= p.minExecutionDate, "Voting period has ended.");
    require(!p.voted[msg.sender], "This address has already voted.");                  
    p.voted[msg.sender] = true;                     
    p.numberOfVotes++;
    voteID = p.numberOfVotes;                     
    p.votes.push(Vote({ inSupport: supportsProposal, voter: msg.sender, justification: justificationText }));
    uint votingPower = getMemberVotingPower(msg.sender);
    if (supportsProposal) {                         
        p.currentResult+= int(votingPower);                          
    } else {                                        
        p.currentResult-= int(votingPower);                          
    }
    
    emit Voted(proposalNumber,  supportsProposal, msg.sender, justificationText);
    return voteID;
}