function referrerWithdraw(
    address _address,
    bool _withdrawAsStable
)
public
{
    require(msg.sender == _address || twoKeyEventSource.isAddressMaintainer(msg.sender));
    address twoKeyAdminAddress;
    address twoKeyUpgradableExchangeContract;

    uint balance;
    address _referrer = twoKeyEventSource.plasmaOf(_address);

    if(referrerPlasma2Balances2key[_referrer] != 0) {
        twoKeyAdminAddress = getContractProxyAddress("TwoKeyAdmin");
        twoKeyUpgradableExchangeContract = getContractProxyAddress("TwoKeyUpgradableExchange");

        balance = referrerPlasma2Balances2key[_referrer];
        referrerPlasma2Balances2key[_referrer] = 0;

        if(_withdrawAsStable == true) {
            IERC20(twoKeyEconomy).approve(twoKeyUpgradableExchangeContract, balance);
            IUpgradableExchange(twoKeyUpgradableExchangeContract).buyStableCoinWith2key(balance, _address);
        }
        else {
            uint rewardsReleaseDate = ITwoKeyAdmin(twoKeyAdminAddress).getTwoKeyRewardsReleaseDate();
            require(block.timestamp >= rewardsReleaseDate, "Rewards period has not ended yet");
            IERC20(twoKeyEconomy).transfer(_address, balance);
        }
    }
    reservedAmount2keyForRewards -= balance;
}