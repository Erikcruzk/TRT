function withdrawTokens(
    uint conversionId,
    uint portion
)
public
{
    Purchase storage p = conversionIdToPurchase[conversionId];
    
    require(msg.sender == p.converter || ITwoKeyEventSource(twoKeyEventSource).isAddressMaintainer(msg.sender) == true, "Not authorized");
    require(p.isPortionWithdrawn[portion] == false && block.timestamp > portionToUnlockingDate[portion], "Portion already withdrawn or time lock not expired");
    
    require(IERC20(assetContractERC20).transfer(p.converter, p.portionAmounts[portion]), "Transfer failed");
    p.isPortionWithdrawn[portion] = true;

    emit TokensWithdrawn (
        block.timestamp,
        msg.sender,
        p.converter, // Fix to use the converter address from the purchase record
        portion,
        p.portionAmounts[portion]
    );
}