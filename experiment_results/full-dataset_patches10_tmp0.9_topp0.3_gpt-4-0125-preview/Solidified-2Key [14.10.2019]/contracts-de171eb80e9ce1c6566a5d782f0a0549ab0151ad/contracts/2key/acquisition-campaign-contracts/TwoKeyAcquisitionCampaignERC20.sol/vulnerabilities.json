{
  "smartbugs_completed": true,
  "analyzer_results": {
    "semgrep": {
      "successfull_analysis": true,
      "errors": [],
      "vulnerability_findings": [
        {
          "name": "array-length-outside-loop",
          "vulnerability_from_line": 848,
          "vulnerability_to_line": null,
          "vulnerability_code": "        while (idx + 65 <= sig.length) {\n",
          "message": "Caching the array length outside a loop saves reading it on each iteration, as long as the array's length is not changed during the loop."
        },
        {
          "name": "array-length-outside-loop",
          "vulnerability_from_line": 852,
          "vulnerability_to_line": null,
          "vulnerability_code": "            if (idx + msg_len <= sig.length) {  // its  a < and not a <= because we dont want this to be the final iteration for the converter\n",
          "message": "Caching the array length outside a loop saves reading it on each iteration, as long as the array's length is not changed during the loop."
        },
        {
          "name": "array-length-outside-loop",
          "vulnerability_from_line": 903,
          "vulnerability_to_line": null,
          "vulnerability_code": "        for(uint i = 0; i < influencers.length; i++) {\n",
          "message": "Caching the array length outside a loop saves reading it on each iteration, as long as the array's length is not changed during the loop."
        },
        {
          "name": "array-length-outside-loop",
          "vulnerability_from_line": 904,
          "vulnerability_to_line": null,
          "vulnerability_code": "            if (i < weights.length) {\n",
          "message": "Caching the array length outside a loop saves reading it on each iteration, as long as the array's length is not changed during the loop."
        },
        {
          "name": "array-length-outside-loop",
          "vulnerability_from_line": 1578,
          "vulnerability_to_line": null,
          "vulnerability_code": "            if (i < keys.length) {\n",
          "message": "Caching the array length outside a loop saves reading it on each iteration, as long as the array's length is not changed during the loop."
        },
        {
          "name": "array-length-outside-loop",
          "vulnerability_from_line": 1584,
          "vulnerability_to_line": null,
          "vulnerability_code": "            if (i < weights.length) {\n",
          "message": "Caching the array length outside a loop saves reading it on each iteration, as long as the array's length is not changed during the loop."
        },
        {
          "name": "unnecessary-checked-arithmetic-in-loop",
          "vulnerability_from_line": 903,
          "vulnerability_to_line": null,
          "vulnerability_code": "        for(uint i = 0; i < influencers.length; i++) {\n",
          "message": "A lot of times there is no risk that the loop counter can overflow. Using Solidity's unchecked block saves the overflow checks."
        },
        {
          "name": "unnecessary-checked-arithmetic-in-loop",
          "vulnerability_from_line": 1877,
          "vulnerability_to_line": null,
          "vulnerability_code": "        for (uint i = 0; i < numberOfInfluencers; i++) {\n",
          "message": "A lot of times there is no risk that the loop counter can overflow. Using Solidity's unchecked block saves the overflow checks."
        },
        {
          "name": "use-custom-error-not-require",
          "vulnerability_from_line": 775,
          "vulnerability_to_line": null,
          "vulnerability_code": "        require (sig.length >= 65+idx, 'bad signature length');\n",
          "message": "Consider using custom errors as they are more gas efficient while allowing developers  to describe the error in detail using NatSpec."
        },
        {
          "name": "use-custom-error-not-require",
          "vulnerability_from_line": 802,
          "vulnerability_to_line": null,
          "vulnerability_code": "        require(v==27 || v==28,'bad sig v');\n",
          "message": "Consider using custom errors as they are more gas efficient while allowing developers  to describe the error in detail using NatSpec."
        },
        {
          "name": "use-custom-error-not-require",
          "vulnerability_from_line": 854,
          "vulnerability_to_line": null,
          "vulnerability_code": "                require(weights[count_influencers] > 0,'weight not defined (1..255)');  // 255 are used to indicate default (equal part) behaviour\n",
          "message": "Consider using custom errors as they are more gas efficient while allowing developers  to describe the error in detail using NatSpec."
        },
        {
          "name": "use-custom-error-not-require",
          "vulnerability_from_line": 884,
          "vulnerability_to_line": null,
          "vulnerability_code": "        require(idx == sig.length,'illegal message size');\n",
          "message": "Consider using custom errors as they are more gas efficient while allowing developers  to describe the error in detail using NatSpec."
        },
        {
          "name": "use-custom-error-not-require",
          "vulnerability_from_line": 894,
          "vulnerability_to_line": null,
          "vulnerability_code": "        require(old_key != address(0),'no public link key');\n",
          "message": "Consider using custom errors as they are more gas efficient while allowing developers  to describe the error in detail using NatSpec."
        },
        {
          "name": "use-custom-error-not-require",
          "vulnerability_from_line": 905,
          "vulnerability_to_line": null,
          "vulnerability_code": "                require (recoverHash(keccak256(abi.encodePacked(weights[i], keys[i], influencers[i])),sig,offsets[i]) == old_key, 'illegal signature');\n",
          "message": "Consider using custom errors as they are more gas efficient while allowing developers  to describe the error in detail using NatSpec."
        },
        {
          "name": "use-custom-error-not-require",
          "vulnerability_from_line": 909,
          "vulnerability_to_line": null,
          "vulnerability_code": "                require (recoverHash(keccak256(abi.encodePacked(influencers[i])),sig,offsets[i]) == old_key, 'illegal last signature');\n",
          "message": "Consider using custom errors as they are more gas efficient while allowing developers  to describe the error in detail using NatSpec."
        },
        {
          "name": "use-custom-error-not-require",
          "vulnerability_from_line": 1569,
          "vulnerability_to_line": null,
          "vulnerability_code": "                require(received_from[new_address] == old_address,'only tree ARCs allowed');\n",
          "message": "Consider using custom errors as they are more gas efficient while allowing developers  to describe the error in detail using NatSpec."
        },
        {
          "name": "use-prefix-increment-not-postfix",
          "vulnerability_from_line": 814,
          "vulnerability_to_line": null,
          "vulnerability_code": "            n_influencers++;\n",
          "message": "Consider using the prefix increment expression whenever the return value is not needed. The prefix increment expression is cheaper in terms of gas."
        },
        {
          "name": "use-prefix-increment-not-postfix",
          "vulnerability_from_line": 855,
          "vulnerability_to_line": null,
          "vulnerability_code": "                idx++;\n",
          "message": "Consider using the prefix increment expression whenever the return value is not needed. The prefix increment expression is cheaper in terms of gas."
        },
        {
          "name": "use-prefix-increment-not-postfix",
          "vulnerability_from_line": 882,
          "vulnerability_to_line": null,
          "vulnerability_code": "            count_influencers++;\n",
          "message": "Consider using the prefix increment expression whenever the return value is not needed. The prefix increment expression is cheaper in terms of gas."
        },
        {
          "name": "use-prefix-increment-not-postfix",
          "vulnerability_from_line": 903,
          "vulnerability_to_line": null,
          "vulnerability_code": "        for(uint i = 0; i < influencers.length; i++) {\n",
          "message": "Consider using the prefix increment expression whenever the return value is not needed. The prefix increment expression is cheaper in terms of gas."
        },
        {
          "name": "use-prefix-increment-not-postfix",
          "vulnerability_from_line": 1563,
          "vulnerability_to_line": null,
          "vulnerability_code": "        for (i = 0; i < numberOfInfluencers; i++) {\n",
          "message": "Consider using the prefix increment expression whenever the return value is not needed. The prefix increment expression is cheaper in terms of gas."
        },
        {
          "name": "use-prefix-increment-not-postfix",
          "vulnerability_from_line": 1877,
          "vulnerability_to_line": null,
          "vulnerability_code": "        for (uint i = 0; i < numberOfInfluencers; i++) {\n",
          "message": "Consider using the prefix increment expression whenever the return value is not needed. The prefix increment expression is cheaper in terms of gas."
        }
      ]
    },
    "slither": {
      "successfull_analysis": true,
      "errors": [
        "EXIT_CODE_198"
      ],
      "vulnerability_findings": [
        {
          "name": "uninitialized-state",
          "vulnerability_from_line": 123,
          "vulnerability_to_line": null,
          "vulnerability_code": "    ITwoKeySingletonesRegistry internal registry;\n",
          "message": "UpgradeabilityStorage.registry (TwoKeyAcquisitionCampaignERC20.sol#123) is never initialized. It is used in:\n\t- initialize (TwoKeyAcquisitionCampaignERC20.sol#146-148)\n"
        },
        {
          "name": "uninitialized-state",
          "vulnerability_from_line": 126,
          "vulnerability_to_line": null,
          "vulnerability_code": "    address internal _implementation;\n",
          "message": "UpgradeabilityStorage._implementation (TwoKeyAcquisitionCampaignERC20.sol#126) is never initialized. It is used in:\n\t- implementation (TwoKeyAcquisitionCampaignERC20.sol#132-134)\n"
        },
        {
          "name": "uninitialized-state",
          "vulnerability_from_line": 1384,
          "vulnerability_to_line": null,
          "vulnerability_code": "    address internal _implementation;\n",
          "message": "UpgradeabilityCampaignStorage._implementation (TwoKeyAcquisitionCampaignERC20.sol#1384) is never initialized. It is used in:\n\t- implementation (TwoKeyAcquisitionCampaignERC20.sol#1390-1392)\n"
        },
        {
          "name": "constant-function",
          "vulnerability_from_line": 659,
          "vulnerability_to_line": 685,
          "vulnerability_code": "    function params0(address c, bytes _method) public view returns (uint answer) {\n\n        // https://medium.com/@blockchain101/calling-the-function-of-another-contract-in-solidity-f9edfa921f4c\n\n        //    dc = c;\n\n        bytes4 sig = bytes4(keccak256(_method));\n\n        assembly {\n\n        // move pointer to free memory spot\n\n            let ptr := mload(0x40)\n\n        // put function sig at memory spot\n\n            mstore(ptr,sig)\n\n\n\n            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n\n            15000, // gas limit\n\n            c, // sload(dc_slot),  // to addr. append var to _slot to access storage variable\n\n            0, // not transfer any ether (comment if using staticcall)\n\n            ptr, // Inputs are stored at location ptr\n\n            0x04, // Inputs are 0 bytes long\n\n            ptr,  //Store output over input\n\n            0x20) //Outputs are 1 bytes long\n\n\n\n            if eq(result, 0) {\n\n                revert(0, 0)\n\n            }\n\n\n\n            answer := mload(ptr) // Assign output to answer var\n\n            mstore(0x40,add(ptr,0x24)) // Set storage pointer to new space\n\n        }\n",
          "message": "Call.params0 (TwoKeyAcquisitionCampaignERC20.sol#659-685) is declared view but contains assembly code\n"
        },
        {
          "name": "constant-function",
          "vulnerability_from_line": 687,
          "vulnerability_to_line": 715,
          "vulnerability_code": "    function params1(address c, bytes _method, uint _val) public view returns (uint answer) {\n\n        // https://medium.com/@blockchain101/calling-the-function-of-another-contract-in-solidity-f9edfa921f4c\n\n        //    dc = c;\n\n        bytes4 sig = bytes4(keccak256(_method));\n\n        assembly {\n\n        // move pointer to free memory spot\n\n            let ptr := mload(0x40)\n\n        // put function sig at memory spot\n\n            mstore(ptr,sig)\n\n        // append argument after function sig\n\n            mstore(add(ptr,0x04), _val)\n\n\n\n            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n\n            15000, // gas limit\n\n            c, // sload(dc_slot),  // to addr. append var to _slot to access storage variable\n\n            0, // not transfer any ether (comment if using staticcall)\n\n            ptr, // Inputs are stored at location ptr\n\n            0x24, // Inputs are 0 bytes long\n\n            ptr,  //Store output over input\n\n            0x20) //Outputs are 1 bytes long\n\n\n\n            if eq(result, 0) {\n\n                revert(0, 0)\n\n            }\n\n\n\n            answer := mload(ptr) // Assign output to answer var\n\n            mstore(0x40,add(ptr,0x24)) // Set storage pointer to new space\n\n        }\n",
          "message": "Call.params1 (TwoKeyAcquisitionCampaignERC20.sol#687-715) is declared view but contains assembly code\n"
        },
        {
          "name": "constant-function",
          "vulnerability_from_line": 717,
          "vulnerability_to_line": 747,
          "vulnerability_code": "    function params2(address c, bytes _method, uint _val1, uint _val2) public view returns (uint answer) {\n\n        // https://medium.com/@blockchain101/calling-the-function-of-another-contract-in-solidity-f9edfa921f4c\n\n        //    dc = c;\n\n        bytes4 sig = bytes4(keccak256(_method));\n\n        assembly {\n\n        // move pointer to free memory spot\n\n            let ptr := mload(0x40)\n\n        // put function sig at memory spot\n\n            mstore(ptr,sig)\n\n        // append argument after function sig\n\n            mstore(add(ptr,0x04), _val1)\n\n            mstore(add(ptr,0x24), _val2)\n\n\n\n            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n\n            15000, // gas limit\n\n            c, // sload(dc_slot),  // to addr. append var to _slot to access storage variable\n\n            0, // not transfer any ether (comment if using staticcall)\n\n            ptr, // Inputs are stored at location ptr\n\n            0x44, // Inputs are 4 bytes for signature and 2 uint256\n\n            ptr,  //Store output over input\n\n            0x20) //Outputs are 1 uint long\n\n\n\n        // TODO cause revert\n\n        //            if eq(result, 0) {\n\n        //                revert(0, 0)\n\n        //            }\n\n\n\n            answer := mload(ptr) // Assign output to answer var\n\n            mstore(0x40,add(ptr,0x20)) // Set storage pointer to new space\n\n        }\n",
          "message": "Call.params2 (TwoKeyAcquisitionCampaignERC20.sol#717-747) is declared view but contains assembly code\n"
        },
        {
          "name": "constant-function",
          "vulnerability_from_line": 749,
          "vulnerability_to_line": 757,
          "vulnerability_code": "    function loadAddress(bytes sig, uint idx) public pure returns (address) {\n\n        address influencer;\n\n        idx += 20;\n\n        assembly\n\n        {\n\n            influencer := mload(add(sig, idx))\n\n        }\n\n        return influencer;\n",
          "message": "Call.loadAddress (TwoKeyAcquisitionCampaignERC20.sol#749-757) is declared view but contains assembly code\n"
        },
        {
          "name": "constant-function",
          "vulnerability_from_line": 759,
          "vulnerability_to_line": 767,
          "vulnerability_code": "    function loadUint8(bytes sig, uint idx) public pure returns (uint8) {\n\n        uint8 weight;\n\n        idx += 1;\n\n        assembly\n\n        {\n\n            weight := mload(add(sig, idx))\n\n        }\n\n        return weight;\n",
          "message": "Call.loadUint8 (TwoKeyAcquisitionCampaignERC20.sol#759-767) is declared view but contains assembly code\n"
        },
        {
          "name": "constant-function",
          "vulnerability_from_line": 770,
          "vulnerability_to_line": 805,
          "vulnerability_code": "    function recoverHash(bytes32 hash, bytes sig, uint idx) public pure returns (address) {\n\n        // same as recoverHash in utils/sign.js\n\n        // The signature format is a compact form of:\n\n        //   {bytes32 r}{bytes32 s}{uint8 v}\n\n        // Compact means, uint8 is not padded to 32 bytes.\n\n        require (sig.length >= 65+idx, 'bad signature length');\n\n        idx += 32;\n\n        bytes32 r;\n\n        assembly\n\n        {\n\n            r := mload(add(sig, idx))\n\n        }\n\n\n\n        idx += 32;\n\n        bytes32 s;\n\n        assembly\n\n        {\n\n            s := mload(add(sig, idx))\n\n        }\n\n\n\n        idx += 1;\n\n        uint8 v;\n\n        assembly\n\n        {\n\n            v := mload(add(sig, idx))\n\n        }\n\n        if (v >= 32) { // handle case when signature was made with ethereum web3.eth.sign or getSign which is for signing ethereum transactions\n\n            v -= 32;\n\n            bytes memory prefix = \"\\x19Ethereum Signed Message:\\n32\"; // 32 is the number of bytes in the following hash\n\n            hash = keccak256(abi.encodePacked(prefix, hash));\n\n        }\n\n        if (v <= 1) v += 27;\n\n        require(v==27 || v==28,'bad sig v');\n\n        return ecrecover(hash, v, r, s);\n\n\n",
          "message": "Call.recoverHash (TwoKeyAcquisitionCampaignERC20.sol#770-805) is declared view but contains assembly code\n"
        },
        {
          "name": "locked-ether",
          "vulnerability_from_line": 146,
          "vulnerability_to_line": 148,
          "vulnerability_code": "    function initialize(address sender) public payable {\n\n        require(msg.sender == address(registry));\n",
          "message": "Contract locking ether found in TwoKeyAcquisitionCampaignERC20.sol:\n\tContract TwoKeyEventSource has payable functions:\n\t - initialize (TwoKeyAcquisitionCampaignERC20.sol#146-148)\n\tBut does not have a function to withdraw the ether\n"
        },
        {
          "name": "reentrancy-no-eth",
          "vulnerability_from_line": 1683,
          "vulnerability_to_line": 1715,
          "vulnerability_code": "    function createConversion(\n\n        uint conversionAmountETHWeiOrFiat,\n\n        address converterAddress,\n\n        bool isFiatConversion,\n\n        bool isAnonymous\n\n    )\n\n    private\n\n    {\n\n        uint baseTokensForConverterUnits;\n\n        uint bonusTokensForConverterUnits;\n\n\n\n        (baseTokensForConverterUnits, bonusTokensForConverterUnits)\n\n        = ITwoKeyAcquisitionLogicHandler(twoKeyAcquisitionLogicHandler).getEstimatedTokenAmount(conversionAmountETHWeiOrFiat, isFiatConversion);\n\n\n\n        uint totalTokensForConverterUnits = baseTokensForConverterUnits + bonusTokensForConverterUnits;\n\n\n\n        uint256 _total_units = getAvailableAndNonReservedTokensAmount();\n\n        require(_total_units >= totalTokensForConverterUnits);\n\n\n\n        uint256 maxReferralRewardFiatOrETHWei = conversionAmountETHWeiOrFiat.mul(maxReferralRewardPercent).div(100);\n\n\n\n        reservedAmountOfTokens = reservedAmountOfTokens + totalTokensForConverterUnits;\n\n\n\n        uint id = ITwoKeyConversionHandler(conversionHandler).supportForCreateConversion(contractor, converterAddress,\n\n            conversionAmountETHWeiOrFiat, maxReferralRewardFiatOrETHWei,\n\n            baseTokensForConverterUnits,bonusTokensForConverterUnits, isFiatConversion, isAnonymous, isKYCRequired);\n\n\n\n        if(isKYCRequired == false) {\n\n            if(isFiatConversion == false || ITwoKeyConversionHandler(conversionHandler).isFiatConversionAutomaticallyApproved()) {\n\n                ITwoKeyConversionHandler(conversionHandler).executeConversion(id);\n\n            }\n\n        }\n",
          "message": "Reentrancy in TwoKeyAcquisitionCampaignERC20.createConversion (TwoKeyAcquisitionCampaignERC20.sol#1683-1715):\n\tExternal calls:\n\t- (baseTokensForConverterUnits,bonusTokensForConverterUnits) = ITwoKeyAcquisitionLogicHandler(twoKeyAcquisitionLogicHandler).getEstimatedTokenAmount(conversionAmountETHWeiOrFiat,isFiatConversion) (TwoKeyAcquisitionCampaignERC20.sol#1694-1695)\n\t- _total_units = getAvailableAndNonReservedTokensAmount() (TwoKeyAcquisitionCampaignERC20.sol#1699)\n\tState variables written after the call(s):\n\t- reservedAmountOfTokens (TwoKeyAcquisitionCampaignERC20.sol#1704)\n"
        },
        {
          "name": "reentrancy-no-eth",
          "vulnerability_from_line": 1549,
          "vulnerability_to_line": 1588,
          "vulnerability_code": "    function distributeArcsBasedOnSignature(\n\n        bytes sig,\n\n        address _converter\n\n    )\n\n    private\n\n    {\n\n        address[] memory influencers;\n\n        address[] memory keys;\n\n        uint8[] memory weights;\n\n        address old_address;\n\n        (influencers, keys, weights, old_address) = super.getInfluencersKeysAndWeightsFromSignature(sig, _converter);\n\n        uint i;\n\n        address new_address;\n\n        uint numberOfInfluencers = influencers.length;\n\n        for (i = 0; i < numberOfInfluencers; i++) {\n\n            new_address = twoKeyEventSource.plasmaOf(influencers[i]);\n\n\n\n            if (received_from[new_address] == 0) {\n\n                transferFrom(old_address, new_address, 1);\n\n            } else {\n\n                require(received_from[new_address] == old_address,'only tree ARCs allowed');\n\n            }\n\n            old_address = new_address;\n\n\n\n            // TODO Updating the public key of influencers may not be a good idea because it will require the influencers to use\n\n            // a deterministic private/public key in the link and this might require user interaction (MetaMask signature)\n\n            // TODO a possible solution is change public_link_key to address=>address[]\n\n            // update (only once) the public address used by each influencer\n\n            // we will need this in case one of the influencers will want to start his own off-chain link\n\n            if (i < keys.length) {\n\n                setPublicLinkKeyOf(new_address, keys[i]);\n\n            }\n\n\n\n            // update (only once) the cut used by each influencer\n\n            // we will need this in case one of the influencers will want to start his own off-chain link\n\n            if (i < weights.length) {\n\n                setCutOf(new_address, uint256(weights[i]));\n\n            }\n\n        }\n",
          "message": "Reentrancy in TwoKeyAcquisitionCampaignERC20.distributeArcsBasedOnSignature (TwoKeyAcquisitionCampaignERC20.sol#1549-1588):\n\tExternal calls:\n\t- (influencers,keys,weights,old_address) = super.getInfluencersKeysAndWeightsFromSignature(sig,_converter) (TwoKeyAcquisitionCampaignERC20.sol#1559)\n\t- new_address = twoKeyEventSource.plasmaOf(influencers[i]) (TwoKeyAcquisitionCampaignERC20.sol#1564)\n\t- transferFrom(old_address,new_address,1) (TwoKeyAcquisitionCampaignERC20.sol#1567)\n\t- setPublicLinkKeyOf(new_address,keys[i]) (TwoKeyAcquisitionCampaignERC20.sol#1579)\n\tState variables written after the call(s):\n\t- public_link_key (TwoKeyAcquisitionCampaignERC20.sol#1579)\n"
        },
        {
          "name": "reentrancy-no-eth",
          "vulnerability_from_line": 1612,
          "vulnerability_to_line": 1620,
          "vulnerability_code": "    function joinAndShareARC(\n\n        bytes signature,\n\n        address receiver\n\n    )\n\n    public\n\n    {\n\n        distributeArcsBasedOnSignature(signature, msg.sender);\n\n        transferFrom(twoKeyEventSource.plasmaOf(msg.sender), twoKeyEventSource.plasmaOf(receiver), 1);\n",
          "message": "Reentrancy in TwoKeyAcquisitionCampaignERC20.joinAndShareARC (TwoKeyAcquisitionCampaignERC20.sol#1612-1620):\n\tExternal calls:\n\t- distributeArcsBasedOnSignature(signature,msg.sender) (TwoKeyAcquisitionCampaignERC20.sol#1618)\n\t- transferFrom(twoKeyEventSource.plasmaOf(msg.sender),twoKeyEventSource.plasmaOf(receiver),1) (TwoKeyAcquisitionCampaignERC20.sol#1619)\n\tState variables written after the call(s):\n\t- balances (TwoKeyAcquisitionCampaignERC20.sol#1619)\n\t- received_from (TwoKeyAcquisitionCampaignERC20.sol#1619)\n\t- totalSupply_ (TwoKeyAcquisitionCampaignERC20.sol#1619)\n"
        },
        {
          "name": "reentrancy-no-eth",
          "vulnerability_from_line": 1256,
          "vulnerability_to_line": 1289,
          "vulnerability_code": "\tfunction referrerWithdraw(\n\n\t\taddress _address,\n\n\t\tbool _withdrawAsStable\n\n\t)\n\n\tpublic\n\n\t{\n\n\t\trequire(msg.sender == _address || twoKeyEventSource.isAddressMaintainer(msg.sender));\n\n\t\taddress twoKeyAdminAddress;\n\n\t\taddress twoKeyUpgradableExchangeContract;\n\n\n\n\t\tuint balance;\n\n\t\taddress _referrer = twoKeyEventSource.plasmaOf(_address);\n\n\n\n\t\tif(referrerPlasma2Balances2key[_referrer] != 0) {\n\n\t\t\ttwoKeyAdminAddress = getContractProxyAddress(\"TwoKeyAdmin\");\n\n\t\t\ttwoKeyUpgradableExchangeContract = getContractProxyAddress(\"TwoKeyUpgradableExchange\");\n\n\n\n\t\t\tbalance = referrerPlasma2Balances2key[_referrer];\n\n\t\t\treferrerPlasma2Balances2key[_referrer] = 0;\n\n\n\n\t\t\tif(_withdrawAsStable == true) {\n\n\t\t\t\tIERC20(twoKeyEconomy).approve(twoKeyUpgradableExchangeContract, balance);\n\n\t\t\t\tIUpgradableExchange(twoKeyUpgradableExchangeContract).buyStableCoinWith2key(balance, _address);\n\n\t\t\t}\n\n\t\t\telse if (block.timestamp >= ITwoKeyAdmin(twoKeyAdminAddress).getTwoKeyRewardsReleaseDate()) {\n\n\t\t\t\tIERC20(twoKeyEconomy).transfer(_address, balance);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\trevert();\n\n\t\t\t}\n\n\n\n\t\t}\n\n        reservedAmount2keyForRewards -= balance;\n",
          "message": "Reentrancy in TwoKeyCampaign.referrerWithdraw (TwoKeyAcquisitionCampaignERC20.sol#1256-1289):\n\tExternal calls:\n\t- require(bool)(msg.sender == _address || twoKeyEventSource.isAddressMaintainer(msg.sender)) (TwoKeyAcquisitionCampaignERC20.sol#1262)\n\t- _referrer = twoKeyEventSource.plasmaOf(_address) (TwoKeyAcquisitionCampaignERC20.sol#1267)\n\t- twoKeyAdminAddress = getContractProxyAddress(TwoKeyAdmin) (TwoKeyAcquisitionCampaignERC20.sol#1270)\n\t- twoKeyUpgradableExchangeContract = getContractProxyAddress(TwoKeyUpgradableExchange) (TwoKeyAcquisitionCampaignERC20.sol#1271)\n\tState variables written after the call(s):\n\t- referrerPlasma2Balances2key (TwoKeyAcquisitionCampaignERC20.sol#1274)\n"
        },
        {
          "name": "reentrancy-no-eth",
          "vulnerability_from_line": 1451,
          "vulnerability_to_line": 1494,
          "vulnerability_code": "    function setInitialParamsCampaign(\n\n        address _twoKeySingletonesRegistry,\n\n        address _twoKeyAcquisitionLogicHandler,\n\n        address _conversionHandler,\n\n        address _moderator,\n\n        address _assetContractERC20,\n\n        address _contractor,\n\n        uint [] values\n\n    )\n\n    public\n\n    {\n\n        require(isCampaignInitialized == false); // Security layer to make sure the function will act as a constructor\n\n\n\n        contractor = _contractor;\n\n        moderator = _moderator;\n\n\n\n        twoKeySingletonesRegistry = _twoKeySingletonesRegistry;\n\n\n\n        twoKeyEventSource = TwoKeyEventSource(getContractProxyAddress(\"TwoKeyEventSource\"));\n\n        twoKeyEconomy = ITwoKeySingletoneRegistryFetchAddress(_twoKeySingletonesRegistry).getNonUpgradableContractAddress(\"TwoKeyEconomy\");\n\n\n\n        if(values[2] == 1) {\n\n            isKYCRequired = true;\n\n        }\n\n\n\n        if(values[3] == 1) {\n\n            mustConvertToReferr = true;\n\n        }\n\n\n\n        totalSupply_ = 1000000;\n\n\n\n        ownerPlasma = twoKeyEventSource.plasmaOf(contractor);\n\n        received_from[ownerPlasma] = ownerPlasma;\n\n        balances[ownerPlasma] = totalSupply_;\n\n\n\n        maxReferralRewardPercent = values[0];\n\n        conversionQuota = values[1];\n\n\n\n        twoKeyAcquisitionLogicHandler = _twoKeyAcquisitionLogicHandler;\n\n        conversionHandler = _conversionHandler;\n\n        assetContractERC20 = _assetContractERC20;\n\n\n\n        isCampaignInitialized = true;\n",
          "message": "Reentrancy in TwoKeyAcquisitionCampaignERC20.setInitialParamsCampaign (TwoKeyAcquisitionCampaignERC20.sol#1451-1494):\n\tExternal calls:\n\t- twoKeyEventSource = TwoKeyEventSource(getContractProxyAddress(TwoKeyEventSource)) (TwoKeyAcquisitionCampaignERC20.sol#1469)\n\t- twoKeyEconomy = ITwoKeySingletoneRegistryFetchAddress(_twoKeySingletonesRegistry).getNonUpgradableContractAddress(TwoKeyEconomy) (TwoKeyAcquisitionCampaignERC20.sol#1470)\n\t- ownerPlasma = twoKeyEventSource.plasmaOf(contractor) (TwoKeyAcquisitionCampaignERC20.sol#1482)\n\tState variables written after the call(s):\n\t- isCampaignInitialized (TwoKeyAcquisitionCampaignERC20.sol#1493)\n"
        },
        {
          "name": "reentrancy-no-eth",
          "vulnerability_from_line": 1006,
          "vulnerability_to_line": 1028,
          "vulnerability_code": "\tfunction transferFrom(\n\n\t\taddress _from,\n\n\t\taddress _to,\n\n\t\tuint256 _value\n\n\t)\n\n\tinternal\n\n\treturns (bool)\n\n\t{\n\n\t\t// _from and _to are assumed to be already converted to plasma address (e.g. using plasmaOf)\n\n\t\trequire(_value == 1);\n\n\t\trequire(balances[_from] > 0);\n\n\n\n\t\tbalances[_from] = balances[_from].sub(1);\n\n\t\tbalances[_to] = balances[_to].add(conversionQuota);\n\n\t\ttotalSupply_ = totalSupply_.add(conversionQuota.sub(1));\n\n\n\n\t\tif (received_from[_to] == 0) {\n\n\t\t\ttwoKeyEventSource.joined(this, _from, _to);\n\n\t\t}\n\n\n\n\t\treceived_from[_to] = _from;\n\n\t\treturn true;\n",
          "message": "Reentrancy in TwoKeyCampaign.transferFrom (TwoKeyAcquisitionCampaignERC20.sol#1006-1028):\n\tExternal calls:\n\t- twoKeyEventSource.joined(this,_from,_to) (TwoKeyAcquisitionCampaignERC20.sol#1023)\n\tState variables written after the call(s):\n\t- received_from (TwoKeyAcquisitionCampaignERC20.sol#1026)\n"
        },
        {
          "name": "uninitialized-local",
          "vulnerability_from_line": 1266,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\tuint balance;\n",
          "message": "balance in TwoKeyCampaign.referrerWithdraw (TwoKeyAcquisitionCampaignERC20.sol#1266) is a local variable never initialiazed\n"
        },
        {
          "name": "uninitialized-local",
          "vulnerability_from_line": 1734,
          "vulnerability_to_line": null,
          "vulnerability_code": "        uint totalBounty2keys;\n",
          "message": "totalBounty2keys in TwoKeyAcquisitionCampaignERC20.buyTokensAndDistributeReferrerRewards (TwoKeyAcquisitionCampaignERC20.sol#1734) is a local variable never initialiazed\n"
        },
        {
          "name": "unused-return",
          "vulnerability_from_line": 1256,
          "vulnerability_to_line": 1289,
          "vulnerability_code": "\tfunction referrerWithdraw(\n\n\t\taddress _address,\n\n\t\tbool _withdrawAsStable\n\n\t)\n\n\tpublic\n\n\t{\n\n\t\trequire(msg.sender == _address || twoKeyEventSource.isAddressMaintainer(msg.sender));\n\n\t\taddress twoKeyAdminAddress;\n\n\t\taddress twoKeyUpgradableExchangeContract;\n\n\n\n\t\tuint balance;\n\n\t\taddress _referrer = twoKeyEventSource.plasmaOf(_address);\n\n\n\n\t\tif(referrerPlasma2Balances2key[_referrer] != 0) {\n\n\t\t\ttwoKeyAdminAddress = getContractProxyAddress(\"TwoKeyAdmin\");\n\n\t\t\ttwoKeyUpgradableExchangeContract = getContractProxyAddress(\"TwoKeyUpgradableExchange\");\n\n\n\n\t\t\tbalance = referrerPlasma2Balances2key[_referrer];\n\n\t\t\treferrerPlasma2Balances2key[_referrer] = 0;\n\n\n\n\t\t\tif(_withdrawAsStable == true) {\n\n\t\t\t\tIERC20(twoKeyEconomy).approve(twoKeyUpgradableExchangeContract, balance);\n\n\t\t\t\tIUpgradableExchange(twoKeyUpgradableExchangeContract).buyStableCoinWith2key(balance, _address);\n\n\t\t\t}\n\n\t\t\telse if (block.timestamp >= ITwoKeyAdmin(twoKeyAdminAddress).getTwoKeyRewardsReleaseDate()) {\n\n\t\t\t\tIERC20(twoKeyEconomy).transfer(_address, balance);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\trevert();\n\n\t\t\t}\n\n\n\n\t\t}\n\n        reservedAmount2keyForRewards -= balance;\n",
          "message": "TwoKeyCampaign.referrerWithdraw (TwoKeyAcquisitionCampaignERC20.sol#1256-1289) does not use the value returned by external calls:\n\t-IERC20(twoKeyEconomy).approve(twoKeyUpgradableExchangeContract,balance) (TwoKeyAcquisitionCampaignERC20.sol#1277)\n\t-IUpgradableExchange(twoKeyUpgradableExchangeContract).buyStableCoinWith2key(balance,_address) (TwoKeyAcquisitionCampaignERC20.sol#1278)\n\t-IERC20(twoKeyEconomy).transfer(_address,balance) (TwoKeyAcquisitionCampaignERC20.sol#1281)\n"
        },
        {
          "name": "unused-return",
          "vulnerability_from_line": 1804,
          "vulnerability_to_line": 1812,
          "vulnerability_code": "    function moveFungibleAsset(\n\n        address _to,\n\n        uint256 _amount\n\n    )\n\n    public\n\n    onlyTwoKeyConversionHandler\n\n    {\n\n        IERC20(assetContractERC20).transfer(_to, _amount);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.moveFungibleAsset (TwoKeyAcquisitionCampaignERC20.sol#1804-1812) does not use the value returned by external calls:\n\t-IERC20(assetContractERC20).transfer(_to,_amount) (TwoKeyAcquisitionCampaignERC20.sol#1811)\n"
        },
        {
          "name": "unused-return",
          "vulnerability_from_line": 1966,
          "vulnerability_to_line": 1977,
          "vulnerability_code": "    function withdrawUnsoldTokens() onlyContractor {\n\n        require(ITwoKeyAcquisitionLogicHandler(twoKeyAcquisitionLogicHandler).checkIsCampaignActive() == false);\n\n        uint unsoldTokens = getAvailableAndNonReservedTokensAmount();\n\n        IERC20(assetContractERC20).transfer(contractor, unsoldTokens);\n\n\n\n        if(assetContractERC20 != twoKeyEconomy) {\n\n            address twoKeyUpgradableExchangeContract = getContractProxyAddress(\"TwoKeyUpgradableExchange\");\n\n            uint rewardsNotSpent = getTokenBalance(twoKeyEconomy) - reservedAmount2keyForRewards;\n\n            IERC20(twoKeyEconomy).approve(twoKeyUpgradableExchangeContract, rewardsNotSpent);\n\n            IUpgradableExchange(twoKeyUpgradableExchangeContract).buyStableCoinWith2key(rewardsNotSpent, msg.sender);\n\n        }\n",
          "message": "TwoKeyAcquisitionCampaignERC20.withdrawUnsoldTokens (TwoKeyAcquisitionCampaignERC20.sol#1966-1977) does not use the value returned by external calls:\n\t-IERC20(assetContractERC20).transfer(contractor,unsoldTokens) (TwoKeyAcquisitionCampaignERC20.sol#1969)\n\t-IERC20(twoKeyEconomy).approve(twoKeyUpgradableExchangeContract,rewardsNotSpent) (TwoKeyAcquisitionCampaignERC20.sol#1974)\n\t-IUpgradableExchange(twoKeyUpgradableExchangeContract).buyStableCoinWith2key(rewardsNotSpent,msg.sender) (TwoKeyAcquisitionCampaignERC20.sol#1975)\n"
        },
        {
          "name": "calls-loop",
          "vulnerability_from_line": 1564,
          "vulnerability_to_line": null,
          "vulnerability_code": "            new_address = twoKeyEventSource.plasmaOf(influencers[i]);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.distributeArcsBasedOnSignature has external calls inside a loop:\n\t- new_address = twoKeyEventSource.plasmaOf(influencers[i]) (TwoKeyAcquisitionCampaignERC20.sol#1564)\n"
        },
        {
          "name": "reentrancy-benign",
          "vulnerability_from_line": 1762,
          "vulnerability_to_line": 1780,
          "vulnerability_code": "    function buyTokensForModeratorRewards(\n\n        uint moderatorFee\n\n    )\n\n    public\n\n    onlyTwoKeyConversionHandler\n\n    {\n\n        //Get deep freeze token pool address\n\n        address twoKeyDeepFreezeTokenPool = getContractProxyAddress(\"TwoKeyDeepFreezeTokenPool\");\n\n\n\n        uint networkFee = twoKeyEventSource.getTwoKeyDefaultNetworkTaxPercent();\n\n\n\n        // Balance which will go to moderator\n\n        uint balance = moderatorFee.mul(100-networkFee).div(100);\n\n\n\n        uint moderatorEarnings2key = buyTokensFromUpgradableExchange(balance,moderator); // Buy tokens for moderator\n\n        buyTokensFromUpgradableExchange(moderatorFee - balance, twoKeyDeepFreezeTokenPool); // Buy tokens for deep freeze token pool\n\n\n\n        moderatorTotalEarnings2key = moderatorTotalEarnings2key.add(moderatorEarnings2key);\n",
          "message": "Reentrancy in TwoKeyAcquisitionCampaignERC20.buyTokensForModeratorRewards (TwoKeyAcquisitionCampaignERC20.sol#1762-1780):\n\tExternal calls:\n\t- twoKeyDeepFreezeTokenPool = getContractProxyAddress(TwoKeyDeepFreezeTokenPool) (TwoKeyAcquisitionCampaignERC20.sol#1769)\n\t- networkFee = twoKeyEventSource.getTwoKeyDefaultNetworkTaxPercent() (TwoKeyAcquisitionCampaignERC20.sol#1771)\n\t- moderatorEarnings2key = buyTokensFromUpgradableExchange(balance,moderator) (TwoKeyAcquisitionCampaignERC20.sol#1776)\n\t- buyTokensFromUpgradableExchange(moderatorFee - balance,twoKeyDeepFreezeTokenPool) (TwoKeyAcquisitionCampaignERC20.sol#1777)\n\tExternal calls sending eth:\n\t- moderatorEarnings2key = buyTokensFromUpgradableExchange(balance,moderator) (TwoKeyAcquisitionCampaignERC20.sol#1776)\n\t- buyTokensFromUpgradableExchange(moderatorFee - balance,twoKeyDeepFreezeTokenPool) (TwoKeyAcquisitionCampaignERC20.sol#1777)\n\tState variables written after the call(s):\n\t- moderatorTotalEarnings2key (TwoKeyAcquisitionCampaignERC20.sol#1779)\n"
        },
        {
          "name": "reentrancy-benign",
          "vulnerability_from_line": 1256,
          "vulnerability_to_line": 1289,
          "vulnerability_code": "\tfunction referrerWithdraw(\n\n\t\taddress _address,\n\n\t\tbool _withdrawAsStable\n\n\t)\n\n\tpublic\n\n\t{\n\n\t\trequire(msg.sender == _address || twoKeyEventSource.isAddressMaintainer(msg.sender));\n\n\t\taddress twoKeyAdminAddress;\n\n\t\taddress twoKeyUpgradableExchangeContract;\n\n\n\n\t\tuint balance;\n\n\t\taddress _referrer = twoKeyEventSource.plasmaOf(_address);\n\n\n\n\t\tif(referrerPlasma2Balances2key[_referrer] != 0) {\n\n\t\t\ttwoKeyAdminAddress = getContractProxyAddress(\"TwoKeyAdmin\");\n\n\t\t\ttwoKeyUpgradableExchangeContract = getContractProxyAddress(\"TwoKeyUpgradableExchange\");\n\n\n\n\t\t\tbalance = referrerPlasma2Balances2key[_referrer];\n\n\t\t\treferrerPlasma2Balances2key[_referrer] = 0;\n\n\n\n\t\t\tif(_withdrawAsStable == true) {\n\n\t\t\t\tIERC20(twoKeyEconomy).approve(twoKeyUpgradableExchangeContract, balance);\n\n\t\t\t\tIUpgradableExchange(twoKeyUpgradableExchangeContract).buyStableCoinWith2key(balance, _address);\n\n\t\t\t}\n\n\t\t\telse if (block.timestamp >= ITwoKeyAdmin(twoKeyAdminAddress).getTwoKeyRewardsReleaseDate()) {\n\n\t\t\t\tIERC20(twoKeyEconomy).transfer(_address, balance);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\trevert();\n\n\t\t\t}\n\n\n\n\t\t}\n\n        reservedAmount2keyForRewards -= balance;\n",
          "message": "Reentrancy in TwoKeyCampaign.referrerWithdraw (TwoKeyAcquisitionCampaignERC20.sol#1256-1289):\n\tExternal calls:\n\t- require(bool)(msg.sender == _address || twoKeyEventSource.isAddressMaintainer(msg.sender)) (TwoKeyAcquisitionCampaignERC20.sol#1262)\n\t- _referrer = twoKeyEventSource.plasmaOf(_address) (TwoKeyAcquisitionCampaignERC20.sol#1267)\n\t- twoKeyAdminAddress = getContractProxyAddress(TwoKeyAdmin) (TwoKeyAcquisitionCampaignERC20.sol#1270)\n\t- twoKeyUpgradableExchangeContract = getContractProxyAddress(TwoKeyUpgradableExchange) (TwoKeyAcquisitionCampaignERC20.sol#1271)\n\t- IERC20(twoKeyEconomy).approve(twoKeyUpgradableExchangeContract,balance) (TwoKeyAcquisitionCampaignERC20.sol#1277)\n\t- IUpgradableExchange(twoKeyUpgradableExchangeContract).buyStableCoinWith2key(balance,_address) (TwoKeyAcquisitionCampaignERC20.sol#1278)\n\t- block.timestamp >= ITwoKeyAdmin(twoKeyAdminAddress).getTwoKeyRewardsReleaseDate() (TwoKeyAcquisitionCampaignERC20.sol#1280-1285)\n\t- IERC20(twoKeyEconomy).transfer(_address,balance) (TwoKeyAcquisitionCampaignERC20.sol#1281)\n\tState variables written after the call(s):\n\t- reservedAmount2keyForRewards (TwoKeyAcquisitionCampaignERC20.sol#1288)\n"
        },
        {
          "name": "reentrancy-benign",
          "vulnerability_from_line": 1517,
          "vulnerability_to_line": 1529,
          "vulnerability_code": "    function setCutOf(\n\n        address me,\n\n        uint256 cut\n\n    )\n\n    internal\n\n    {\n\n        // what is the percentage of the bounty s/he will receive when acting as an influencer\n\n        // the value 255 is used to signal equal partition with other influencers\n\n        // A sender can set the value only once in a contract\n\n        address plasma = twoKeyEventSource.plasmaOf(me);\n\n        require(referrerPlasma2cut[plasma] == 0 || referrerPlasma2cut[plasma] == cut);\n\n        referrerPlasma2cut[plasma] = cut;\n",
          "message": "Reentrancy in TwoKeyAcquisitionCampaignERC20.setCutOf (TwoKeyAcquisitionCampaignERC20.sol#1517-1529):\n\tExternal calls:\n\t- plasma = twoKeyEventSource.plasmaOf(me) (TwoKeyAcquisitionCampaignERC20.sol#1526)\n\tState variables written after the call(s):\n\t- referrerPlasma2cut (TwoKeyAcquisitionCampaignERC20.sol#1528)\n"
        },
        {
          "name": "reentrancy-benign",
          "vulnerability_from_line": 1451,
          "vulnerability_to_line": 1494,
          "vulnerability_code": "    function setInitialParamsCampaign(\n\n        address _twoKeySingletonesRegistry,\n\n        address _twoKeyAcquisitionLogicHandler,\n\n        address _conversionHandler,\n\n        address _moderator,\n\n        address _assetContractERC20,\n\n        address _contractor,\n\n        uint [] values\n\n    )\n\n    public\n\n    {\n\n        require(isCampaignInitialized == false); // Security layer to make sure the function will act as a constructor\n\n\n\n        contractor = _contractor;\n\n        moderator = _moderator;\n\n\n\n        twoKeySingletonesRegistry = _twoKeySingletonesRegistry;\n\n\n\n        twoKeyEventSource = TwoKeyEventSource(getContractProxyAddress(\"TwoKeyEventSource\"));\n\n        twoKeyEconomy = ITwoKeySingletoneRegistryFetchAddress(_twoKeySingletonesRegistry).getNonUpgradableContractAddress(\"TwoKeyEconomy\");\n\n\n\n        if(values[2] == 1) {\n\n            isKYCRequired = true;\n\n        }\n\n\n\n        if(values[3] == 1) {\n\n            mustConvertToReferr = true;\n\n        }\n\n\n\n        totalSupply_ = 1000000;\n\n\n\n        ownerPlasma = twoKeyEventSource.plasmaOf(contractor);\n\n        received_from[ownerPlasma] = ownerPlasma;\n\n        balances[ownerPlasma] = totalSupply_;\n\n\n\n        maxReferralRewardPercent = values[0];\n\n        conversionQuota = values[1];\n\n\n\n        twoKeyAcquisitionLogicHandler = _twoKeyAcquisitionLogicHandler;\n\n        conversionHandler = _conversionHandler;\n\n        assetContractERC20 = _assetContractERC20;\n\n\n\n        isCampaignInitialized = true;\n",
          "message": "Reentrancy in TwoKeyAcquisitionCampaignERC20.setInitialParamsCampaign (TwoKeyAcquisitionCampaignERC20.sol#1451-1494):\n\tExternal calls:\n\t- twoKeyEventSource = TwoKeyEventSource(getContractProxyAddress(TwoKeyEventSource)) (TwoKeyAcquisitionCampaignERC20.sol#1469)\n\t- twoKeyEconomy = ITwoKeySingletoneRegistryFetchAddress(_twoKeySingletonesRegistry).getNonUpgradableContractAddress(TwoKeyEconomy) (TwoKeyAcquisitionCampaignERC20.sol#1470)\n\tState variables written after the call(s):\n\t- isKYCRequired (TwoKeyAcquisitionCampaignERC20.sol#1473)\n\t- mustConvertToReferr (TwoKeyAcquisitionCampaignERC20.sol#1477)\n\t- totalSupply_ (TwoKeyAcquisitionCampaignERC20.sol#1480)\n\t- twoKeyEconomy (TwoKeyAcquisitionCampaignERC20.sol#1470)\n"
        },
        {
          "name": "reentrancy-benign",
          "vulnerability_from_line": 1451,
          "vulnerability_to_line": 1494,
          "vulnerability_code": "    function setInitialParamsCampaign(\n\n        address _twoKeySingletonesRegistry,\n\n        address _twoKeyAcquisitionLogicHandler,\n\n        address _conversionHandler,\n\n        address _moderator,\n\n        address _assetContractERC20,\n\n        address _contractor,\n\n        uint [] values\n\n    )\n\n    public\n\n    {\n\n        require(isCampaignInitialized == false); // Security layer to make sure the function will act as a constructor\n\n\n\n        contractor = _contractor;\n\n        moderator = _moderator;\n\n\n\n        twoKeySingletonesRegistry = _twoKeySingletonesRegistry;\n\n\n\n        twoKeyEventSource = TwoKeyEventSource(getContractProxyAddress(\"TwoKeyEventSource\"));\n\n        twoKeyEconomy = ITwoKeySingletoneRegistryFetchAddress(_twoKeySingletonesRegistry).getNonUpgradableContractAddress(\"TwoKeyEconomy\");\n\n\n\n        if(values[2] == 1) {\n\n            isKYCRequired = true;\n\n        }\n\n\n\n        if(values[3] == 1) {\n\n            mustConvertToReferr = true;\n\n        }\n\n\n\n        totalSupply_ = 1000000;\n\n\n\n        ownerPlasma = twoKeyEventSource.plasmaOf(contractor);\n\n        received_from[ownerPlasma] = ownerPlasma;\n\n        balances[ownerPlasma] = totalSupply_;\n\n\n\n        maxReferralRewardPercent = values[0];\n\n        conversionQuota = values[1];\n\n\n\n        twoKeyAcquisitionLogicHandler = _twoKeyAcquisitionLogicHandler;\n\n        conversionHandler = _conversionHandler;\n\n        assetContractERC20 = _assetContractERC20;\n\n\n\n        isCampaignInitialized = true;\n",
          "message": "Reentrancy in TwoKeyAcquisitionCampaignERC20.setInitialParamsCampaign (TwoKeyAcquisitionCampaignERC20.sol#1451-1494):\n\tExternal calls:\n\t- twoKeyEventSource = TwoKeyEventSource(getContractProxyAddress(TwoKeyEventSource)) (TwoKeyAcquisitionCampaignERC20.sol#1469)\n\t- twoKeyEconomy = ITwoKeySingletoneRegistryFetchAddress(_twoKeySingletonesRegistry).getNonUpgradableContractAddress(TwoKeyEconomy) (TwoKeyAcquisitionCampaignERC20.sol#1470)\n\t- ownerPlasma = twoKeyEventSource.plasmaOf(contractor) (TwoKeyAcquisitionCampaignERC20.sol#1482)\n\tState variables written after the call(s):\n\t- assetContractERC20 (TwoKeyAcquisitionCampaignERC20.sol#1491)\n\t- balances (TwoKeyAcquisitionCampaignERC20.sol#1484)\n\t- conversionHandler (TwoKeyAcquisitionCampaignERC20.sol#1490)\n\t- conversionQuota (TwoKeyAcquisitionCampaignERC20.sol#1487)\n\t- maxReferralRewardPercent (TwoKeyAcquisitionCampaignERC20.sol#1486)\n\t- ownerPlasma (TwoKeyAcquisitionCampaignERC20.sol#1482)\n\t- received_from (TwoKeyAcquisitionCampaignERC20.sol#1483)\n\t- twoKeyAcquisitionLogicHandler (TwoKeyAcquisitionCampaignERC20.sol#1489)\n"
        },
        {
          "name": "reentrancy-benign",
          "vulnerability_from_line": 1036,
          "vulnerability_to_line": 1051,
          "vulnerability_code": "    function setPublicLinkKeyOf(\n\n\t\taddress me,\n\n\t\taddress new_public_key\n\n\t)\n\n\tinternal\n\n\t{\n\n        me = twoKeyEventSource.plasmaOf(me);\n\n        require(balanceOf(me) > 0);\n\n        address old_address = public_link_key[me];\n\n        if (old_address == address(0)) {\n\n            public_link_key[me] = new_public_key;\n\n        } else {\n\n            require(old_address == new_public_key);\n\n        }\n\n        public_link_key[me] = new_public_key;\n",
          "message": "Reentrancy in TwoKeyCampaign.setPublicLinkKeyOf (TwoKeyAcquisitionCampaignERC20.sol#1036-1051):\n\tExternal calls:\n\t- me = twoKeyEventSource.plasmaOf(me) (TwoKeyAcquisitionCampaignERC20.sol#1042)\n\tState variables written after the call(s):\n\t- public_link_key (TwoKeyAcquisitionCampaignERC20.sol#1046)\n\t- public_link_key (TwoKeyAcquisitionCampaignERC20.sol#1050)\n"
        },
        {
          "name": "timestamp",
          "vulnerability_from_line": 1256,
          "vulnerability_to_line": 1289,
          "vulnerability_code": "\tfunction referrerWithdraw(\n\n\t\taddress _address,\n\n\t\tbool _withdrawAsStable\n\n\t)\n\n\tpublic\n\n\t{\n\n\t\trequire(msg.sender == _address || twoKeyEventSource.isAddressMaintainer(msg.sender));\n\n\t\taddress twoKeyAdminAddress;\n\n\t\taddress twoKeyUpgradableExchangeContract;\n\n\n\n\t\tuint balance;\n\n\t\taddress _referrer = twoKeyEventSource.plasmaOf(_address);\n\n\n\n\t\tif(referrerPlasma2Balances2key[_referrer] != 0) {\n\n\t\t\ttwoKeyAdminAddress = getContractProxyAddress(\"TwoKeyAdmin\");\n\n\t\t\ttwoKeyUpgradableExchangeContract = getContractProxyAddress(\"TwoKeyUpgradableExchange\");\n\n\n\n\t\t\tbalance = referrerPlasma2Balances2key[_referrer];\n\n\t\t\treferrerPlasma2Balances2key[_referrer] = 0;\n\n\n\n\t\t\tif(_withdrawAsStable == true) {\n\n\t\t\t\tIERC20(twoKeyEconomy).approve(twoKeyUpgradableExchangeContract, balance);\n\n\t\t\t\tIUpgradableExchange(twoKeyUpgradableExchangeContract).buyStableCoinWith2key(balance, _address);\n\n\t\t\t}\n\n\t\t\telse if (block.timestamp >= ITwoKeyAdmin(twoKeyAdminAddress).getTwoKeyRewardsReleaseDate()) {\n\n\t\t\t\tIERC20(twoKeyEconomy).transfer(_address, balance);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\trevert();\n\n\t\t\t}\n\n\n\n\t\t}\n\n        reservedAmount2keyForRewards -= balance;\n",
          "message": "TwoKeyCampaign.referrerWithdraw (TwoKeyAcquisitionCampaignERC20.sol#1256-1289) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- block.timestamp >= ITwoKeyAdmin(twoKeyAdminAddress).getTwoKeyRewardsReleaseDate() (TwoKeyAcquisitionCampaignERC20.sol#1280-1285)\n"
        },
        {
          "name": "assembly",
          "vulnerability_from_line": 659,
          "vulnerability_to_line": 685,
          "vulnerability_code": "    function params0(address c, bytes _method) public view returns (uint answer) {\n\n        // https://medium.com/@blockchain101/calling-the-function-of-another-contract-in-solidity-f9edfa921f4c\n\n        //    dc = c;\n\n        bytes4 sig = bytes4(keccak256(_method));\n\n        assembly {\n\n        // move pointer to free memory spot\n\n            let ptr := mload(0x40)\n\n        // put function sig at memory spot\n\n            mstore(ptr,sig)\n\n\n\n            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n\n            15000, // gas limit\n\n            c, // sload(dc_slot),  // to addr. append var to _slot to access storage variable\n\n            0, // not transfer any ether (comment if using staticcall)\n\n            ptr, // Inputs are stored at location ptr\n\n            0x04, // Inputs are 0 bytes long\n\n            ptr,  //Store output over input\n\n            0x20) //Outputs are 1 bytes long\n\n\n\n            if eq(result, 0) {\n\n                revert(0, 0)\n\n            }\n\n\n\n            answer := mload(ptr) // Assign output to answer var\n\n            mstore(0x40,add(ptr,0x24)) // Set storage pointer to new space\n\n        }\n",
          "message": "Call.params0 uses assembly (TwoKeyAcquisitionCampaignERC20.sol#659-685)\n\t- TwoKeyAcquisitionCampaignERC20.sol#663-685\n"
        },
        {
          "name": "assembly",
          "vulnerability_from_line": 687,
          "vulnerability_to_line": 715,
          "vulnerability_code": "    function params1(address c, bytes _method, uint _val) public view returns (uint answer) {\n\n        // https://medium.com/@blockchain101/calling-the-function-of-another-contract-in-solidity-f9edfa921f4c\n\n        //    dc = c;\n\n        bytes4 sig = bytes4(keccak256(_method));\n\n        assembly {\n\n        // move pointer to free memory spot\n\n            let ptr := mload(0x40)\n\n        // put function sig at memory spot\n\n            mstore(ptr,sig)\n\n        // append argument after function sig\n\n            mstore(add(ptr,0x04), _val)\n\n\n\n            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n\n            15000, // gas limit\n\n            c, // sload(dc_slot),  // to addr. append var to _slot to access storage variable\n\n            0, // not transfer any ether (comment if using staticcall)\n\n            ptr, // Inputs are stored at location ptr\n\n            0x24, // Inputs are 0 bytes long\n\n            ptr,  //Store output over input\n\n            0x20) //Outputs are 1 bytes long\n\n\n\n            if eq(result, 0) {\n\n                revert(0, 0)\n\n            }\n\n\n\n            answer := mload(ptr) // Assign output to answer var\n\n            mstore(0x40,add(ptr,0x24)) // Set storage pointer to new space\n\n        }\n",
          "message": "Call.params1 uses assembly (TwoKeyAcquisitionCampaignERC20.sol#687-715)\n\t- TwoKeyAcquisitionCampaignERC20.sol#691-715\n"
        },
        {
          "name": "assembly",
          "vulnerability_from_line": 717,
          "vulnerability_to_line": 747,
          "vulnerability_code": "    function params2(address c, bytes _method, uint _val1, uint _val2) public view returns (uint answer) {\n\n        // https://medium.com/@blockchain101/calling-the-function-of-another-contract-in-solidity-f9edfa921f4c\n\n        //    dc = c;\n\n        bytes4 sig = bytes4(keccak256(_method));\n\n        assembly {\n\n        // move pointer to free memory spot\n\n            let ptr := mload(0x40)\n\n        // put function sig at memory spot\n\n            mstore(ptr,sig)\n\n        // append argument after function sig\n\n            mstore(add(ptr,0x04), _val1)\n\n            mstore(add(ptr,0x24), _val2)\n\n\n\n            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n\n            15000, // gas limit\n\n            c, // sload(dc_slot),  // to addr. append var to _slot to access storage variable\n\n            0, // not transfer any ether (comment if using staticcall)\n\n            ptr, // Inputs are stored at location ptr\n\n            0x44, // Inputs are 4 bytes for signature and 2 uint256\n\n            ptr,  //Store output over input\n\n            0x20) //Outputs are 1 uint long\n\n\n\n        // TODO cause revert\n\n        //            if eq(result, 0) {\n\n        //                revert(0, 0)\n\n        //            }\n\n\n\n            answer := mload(ptr) // Assign output to answer var\n\n            mstore(0x40,add(ptr,0x20)) // Set storage pointer to new space\n\n        }\n",
          "message": "Call.params2 uses assembly (TwoKeyAcquisitionCampaignERC20.sol#717-747)\n\t- TwoKeyAcquisitionCampaignERC20.sol#721-747\n"
        },
        {
          "name": "assembly",
          "vulnerability_from_line": 749,
          "vulnerability_to_line": 757,
          "vulnerability_code": "    function loadAddress(bytes sig, uint idx) public pure returns (address) {\n\n        address influencer;\n\n        idx += 20;\n\n        assembly\n\n        {\n\n            influencer := mload(add(sig, idx))\n\n        }\n\n        return influencer;\n",
          "message": "Call.loadAddress uses assembly (TwoKeyAcquisitionCampaignERC20.sol#749-757)\n\t- TwoKeyAcquisitionCampaignERC20.sol#752-756\n"
        },
        {
          "name": "assembly",
          "vulnerability_from_line": 759,
          "vulnerability_to_line": 767,
          "vulnerability_code": "    function loadUint8(bytes sig, uint idx) public pure returns (uint8) {\n\n        uint8 weight;\n\n        idx += 1;\n\n        assembly\n\n        {\n\n            weight := mload(add(sig, idx))\n\n        }\n\n        return weight;\n",
          "message": "Call.loadUint8 uses assembly (TwoKeyAcquisitionCampaignERC20.sol#759-767)\n\t- TwoKeyAcquisitionCampaignERC20.sol#762-766\n"
        },
        {
          "name": "assembly",
          "vulnerability_from_line": 770,
          "vulnerability_to_line": 805,
          "vulnerability_code": "    function recoverHash(bytes32 hash, bytes sig, uint idx) public pure returns (address) {\n\n        // same as recoverHash in utils/sign.js\n\n        // The signature format is a compact form of:\n\n        //   {bytes32 r}{bytes32 s}{uint8 v}\n\n        // Compact means, uint8 is not padded to 32 bytes.\n\n        require (sig.length >= 65+idx, 'bad signature length');\n\n        idx += 32;\n\n        bytes32 r;\n\n        assembly\n\n        {\n\n            r := mload(add(sig, idx))\n\n        }\n\n\n\n        idx += 32;\n\n        bytes32 s;\n\n        assembly\n\n        {\n\n            s := mload(add(sig, idx))\n\n        }\n\n\n\n        idx += 1;\n\n        uint8 v;\n\n        assembly\n\n        {\n\n            v := mload(add(sig, idx))\n\n        }\n\n        if (v >= 32) { // handle case when signature was made with ethereum web3.eth.sign or getSign which is for signing ethereum transactions\n\n            v -= 32;\n\n            bytes memory prefix = \"\\x19Ethereum Signed Message:\\n32\"; // 32 is the number of bytes in the following hash\n\n            hash = keccak256(abi.encodePacked(prefix, hash));\n\n        }\n\n        if (v <= 1) v += 27;\n\n        require(v==27 || v==28,'bad sig v');\n\n        return ecrecover(hash, v, r, s);\n\n\n",
          "message": "Call.recoverHash uses assembly (TwoKeyAcquisitionCampaignERC20.sol#770-805)\n\t- TwoKeyAcquisitionCampaignERC20.sol#778-783\n\t- TwoKeyAcquisitionCampaignERC20.sol#785-790\n\t- TwoKeyAcquisitionCampaignERC20.sol#792-796\n"
        },
        {
          "name": "assembly",
          "vulnerability_from_line": 1058,
          "vulnerability_to_line": 1108,
          "vulnerability_code": "\tfunction getInfluencersKeysAndWeightsFromSignature(\n\n\t\tbytes sig,\n\n\t\taddress _converter\n\n\t)\n\n\tinternal\n\n\treturns (address[],address[],uint8[],address)\n\n\t{\n\n\t\t// move ARCs and set public_link keys and weights/cuts based on signature information\n\n\t\t// returns the last address in the sig\n\n\n\n\t\t// sig structure:\n\n\t\t// 1 byte version 0 or 1\n\n\t\t// 20 bytes are the address of the contractor or the influencer who created sig.\n\n\t\t//  this is the \"anchor\" of the link\n\n\t\t//  It must have a public key aleady stored for it in public_link_key\n\n\t\t// Begining of a loop on steps in the link:\n\n\t\t// * 65 bytes are step-signature using the secret from previous step\n\n\t\t// * message of the step that is going to be hashed and used to compute the above step-signature.\n\n\t\t//   message length depend on version 41 (version 0) or 86 (version 1):\n\n\t\t//   * 1 byte cut (percentage) each influencer takes from the bounty. the cut is stored in influencer2cut or weight for voting\n\n\t\t//   * 20 bytes address of influencer (version 0) or 65 bytes of signature of cut using the influencer address to sign\n\n\t\t//   * 20 bytes public key of the last secret\n\n\t\t// In the last step the message can be optional. If it is missing the message used is the address of the sender\n\n\t\taddress old_address;\n\n\t\t/**\n\n           old address -> plasma address\n\n           old key -> publicLinkKey[plasma]\n\n         */\n\n\t\tassembly\n\n\t\t{\n\n\t\t\told_address := mload(add(sig, 21))\n\n\t\t}\n\n\n\n\t\told_address = twoKeyEventSource.plasmaOf(old_address);\n\n\t\taddress old_key = public_link_key[old_address];\n\n\n\n\t\taddress[] memory influencers;\n\n\t\taddress[] memory keys;\n\n\t\tuint8[] memory weights;\n\n\t\t(influencers, keys, weights) = Call.recoverSig(sig, old_key, twoKeyEventSource.plasmaOf(_converter));\n\n\n\n\t\t// check if we exactly reached the end of the signature. this can only happen if the signature\n\n\t\t// was generated with free_join_take and in this case the last part of the signature must have been\n\n\t\t// generated by the caller of this method\n\n\t\trequire(// influencers[influencers.length-1] == msg.sender ||\n\n\t\t\tinfluencers[influencers.length-1] == twoKeyEventSource.plasmaOf(_converter) ||\n\n\t\t\tcontractor == msg.sender\n\n\t\t);\n\n\n\n\t\treturn (influencers, keys, weights, old_address);\n",
          "message": "TwoKeyCampaign.getInfluencersKeysAndWeightsFromSignature uses assembly (TwoKeyAcquisitionCampaignERC20.sol#1058-1108)\n\t- TwoKeyAcquisitionCampaignERC20.sol#1086-1091\n"
        },
        {
          "name": "constable-states",
          "vulnerability_from_line": 1355,
          "vulnerability_to_line": null,
          "vulnerability_code": "    bool public IS_CAMPAIGN_ACTIVE;\n",
          "message": "ITwoKeyAcquisitionLogicHandler.IS_CAMPAIGN_ACTIVE should be constant (TwoKeyAcquisitionCampaignERC20.sol#1355)\nITwoKeyConversionHandler.isFiatConversionAutomaticallyApproved should be constant (TwoKeyAcquisitionCampaignERC20.sol#1298)\nUpgradeabilityCampaignStorage._implementation should be constant (TwoKeyAcquisitionCampaignERC20.sol#1384)\nUpgradeabilityCampaignStorage.twoKeyFactory should be constant (TwoKeyAcquisitionCampaignERC20.sol#1381)\nUpgradeabilityStorage._implementation should be constant (TwoKeyAcquisitionCampaignERC20.sol#126)\n"
        },
        {
          "name": "pragma",
          "vulnerability_from_line": 3,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": "Different versions of Solidity is used in TwoKeyAcquisitionCampaignERC20.sol:\n\t- Version used: ['^0.4.0', '^0.4.24']\n\t- TwoKeyAcquisitionCampaignERC20.sol#3 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#30 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#40 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#54 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#67 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#75 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#115 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#139 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#153 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#176 declares pragma solidity^0.4.0\n\t- TwoKeyAcquisitionCampaignERC20.sol#227 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#235 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#509 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#534 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#601 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#656 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#919 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#950 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#1294 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#1348 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#1371 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#1397 declares pragma solidity^0.4.24\n\t- TwoKeyAcquisitionCampaignERC20.sol#1410 declares pragma solidity^0.4.24\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 7,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addTwoKeyEventSource(address _twoKeyEventSource) public;\n",
          "message": "ITwoKeyReg.addTwoKeyEventSource (TwoKeyAcquisitionCampaignERC20.sol#7) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 8,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function changeTwoKeyEventSource(address _twoKeyEventSource) public;\n",
          "message": "ITwoKeyReg.changeTwoKeyEventSource (TwoKeyAcquisitionCampaignERC20.sol#8) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 9,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addWhereContractor(address _userAddress, address _contractAddress) public;\n",
          "message": "ITwoKeyReg.addWhereContractor (TwoKeyAcquisitionCampaignERC20.sol#9) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 10,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addWhereModerator(address _userAddress, address _contractAddress) public;\n",
          "message": "ITwoKeyReg.addWhereModerator (TwoKeyAcquisitionCampaignERC20.sol#10) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 11,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addWhereReferrer(address _userAddress, address _contractAddress) public;\n",
          "message": "ITwoKeyReg.addWhereReferrer (TwoKeyAcquisitionCampaignERC20.sol#11) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 12,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addWhereConverter(address _userAddress, address _contractAddress) public;\n",
          "message": "ITwoKeyReg.addWhereConverter (TwoKeyAcquisitionCampaignERC20.sol#12) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 13,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getContractsWhereUserIsContractor(address _userAddress) public view returns (address[]);\n",
          "message": "ITwoKeyReg.getContractsWhereUserIsContractor (TwoKeyAcquisitionCampaignERC20.sol#13) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 14,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getContractsWhereUserIsModerator(address _userAddress) public view returns (address[]);\n",
          "message": "ITwoKeyReg.getContractsWhereUserIsModerator (TwoKeyAcquisitionCampaignERC20.sol#14) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 15,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getContractsWhereUserIsRefferer(address _userAddress) public view returns (address[]);\n",
          "message": "ITwoKeyReg.getContractsWhereUserIsRefferer (TwoKeyAcquisitionCampaignERC20.sol#15) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 16,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getContractsWhereUserIsConverter(address _userAddress) public view returns (address[]);\n",
          "message": "ITwoKeyReg.getContractsWhereUserIsConverter (TwoKeyAcquisitionCampaignERC20.sol#16) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 17,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getTwoKeyEventSourceAddress() public view returns (address);\n",
          "message": "ITwoKeyReg.getTwoKeyEventSourceAddress (TwoKeyAcquisitionCampaignERC20.sol#17) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 18,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addName(string _name, address _sender, string _fullName, string _email, bytes signature) public;\n",
          "message": "ITwoKeyReg.addName (TwoKeyAcquisitionCampaignERC20.sol#18) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 19,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addNameByUser(string _name) public;\n",
          "message": "ITwoKeyReg.addNameByUser (TwoKeyAcquisitionCampaignERC20.sol#19) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 20,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getName2Owner(string _name) public view returns (address);\n",
          "message": "ITwoKeyReg.getName2Owner (TwoKeyAcquisitionCampaignERC20.sol#20) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 21,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getOwner2Name(address _sender) public view returns (string);\n",
          "message": "ITwoKeyReg.getOwner2Name (TwoKeyAcquisitionCampaignERC20.sol#21) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 22,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getPlasmaToEthereum(address plasma) public view returns (address);\n",
          "message": "ITwoKeyReg.getPlasmaToEthereum (TwoKeyAcquisitionCampaignERC20.sol#22) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 23,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getEthereumToPlasma(address ethereum) public view returns (address);\n",
          "message": "ITwoKeyReg.getEthereumToPlasma (TwoKeyAcquisitionCampaignERC20.sol#23) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 24,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function checkIfTwoKeyMaintainerExists(address _maintainer) public view returns (bool);\n",
          "message": "ITwoKeyReg.checkIfTwoKeyMaintainerExists (TwoKeyAcquisitionCampaignERC20.sol#24) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 33,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getDefaultIntegratorFeePercent() public view returns (uint);\n",
          "message": "ITwoKeyAdmin.getDefaultIntegratorFeePercent (TwoKeyAcquisitionCampaignERC20.sol#33) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 34,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getDefaultNetworkTaxPercent() public view returns (uint);\n",
          "message": "ITwoKeyAdmin.getDefaultNetworkTaxPercent (TwoKeyAcquisitionCampaignERC20.sol#34) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 46,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function isCampaignValidated(address campaign) public view returns (bool);\n",
          "message": "ITwoKeyCampaignValidator.isCampaignValidated (TwoKeyAcquisitionCampaignERC20.sol#46) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 47,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function isConversionHandlerCodeValid(address conversionHandler) public view returns (bool);\n",
          "message": "ITwoKeyCampaignValidator.isConversionHandlerCodeValid (TwoKeyAcquisitionCampaignERC20.sol#47) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 48,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function validateAcquisitionCampaign(address campaign, string nonSingletonHash) public;\n",
          "message": "ITwoKeyCampaignValidator.validateAcquisitionCampaign (TwoKeyAcquisitionCampaignERC20.sol#48) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 49,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function validateDonationCampaign(address campaign, address donationConversionHandler, string nonSingletonHash) public;\n",
          "message": "ITwoKeyCampaignValidator.validateDonationCampaign (TwoKeyAcquisitionCampaignERC20.sol#49) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 60,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getContractProxyAddress(string _contractName) public view returns (address);\n",
          "message": "ITwoKeySingletoneRegistryFetchAddress.getContractProxyAddress (TwoKeyAcquisitionCampaignERC20.sol#60) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 61,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getNonUpgradableContractAddress(string contractName) public view returns (address);\n",
          "message": "ITwoKeySingletoneRegistryFetchAddress.getNonUpgradableContractAddress (TwoKeyAcquisitionCampaignERC20.sol#61) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 62,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getLatestContractVersion(string contractName) public view returns (string);\n",
          "message": "ITwoKeySingletoneRegistryFetchAddress.getLatestContractVersion (TwoKeyAcquisitionCampaignERC20.sol#62) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 70,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function onlyMaintainer(address _sender) public view returns (bool);\n",
          "message": "ITwoKeyMaintainersRegistry.onlyMaintainer (TwoKeyAcquisitionCampaignERC20.sol#70) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 102,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addVersion(string _contractName, string version, address implementation) public;\n",
          "message": "ITwoKeySingletonesRegistry.addVersion (TwoKeyAcquisitionCampaignERC20.sol#102) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 110,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getVersion(string _contractName, string version) public view returns (address);\n",
          "message": "ITwoKeySingletonesRegistry.getVersion (TwoKeyAcquisitionCampaignERC20.sol#110) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 132,
          "vulnerability_to_line": 134,
          "vulnerability_code": "    function implementation() public view returns (address) {\n\n        return _implementation;\n",
          "message": "UpgradeabilityStorage.implementation (TwoKeyAcquisitionCampaignERC20.sol#132-134) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 146,
          "vulnerability_to_line": 148,
          "vulnerability_code": "    function initialize(address sender) public payable {\n\n        require(msg.sender == address(registry));\n",
          "message": "Upgradeable.initialize (TwoKeyAcquisitionCampaignERC20.sol#146-148) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 429,
          "vulnerability_to_line": 442,
          "vulnerability_code": "    function plasmaOf(\n\n        address me\n\n    )\n\n    public\n\n    view\n\n    returns (address)\n\n    {\n\n        address twoKeyRegistry = getAddressFromTwoKeySingletonRegistry(\"TwoKeyRegistry\");\n\n        address plasma = ITwoKeyReg(twoKeyRegistry).getEthereumToPlasma(me);\n\n        if (plasma != address(0)) {\n\n            return plasma;\n\n        }\n\n        return me;\n",
          "message": "TwoKeyEventSource.plasmaOf (TwoKeyAcquisitionCampaignERC20.sol#429-442) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 449,
          "vulnerability_to_line": 462,
          "vulnerability_code": "    function ethereumOf(\n\n        address me\n\n    )\n\n    public\n\n    view\n\n    returns (address)\n\n    {\n\n        address twoKeyRegistry = getAddressFromTwoKeySingletonRegistry(\"TwoKeyRegistry\");\n\n        address ethereum = ITwoKeyReg(twoKeyRegistry).getPlasmaToEthereum(me);\n\n        if (ethereum != address(0)) {\n\n            return ethereum;\n\n        }\n\n        return me;\n",
          "message": "TwoKeyEventSource.ethereumOf (TwoKeyAcquisitionCampaignERC20.sol#449-462) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 468,
          "vulnerability_to_line": 478,
          "vulnerability_code": "    function isAddressMaintainer(\n\n        address _maintainer\n\n    )\n\n    public\n\n    view\n\n    returns (bool)\n\n    {\n\n        address twoKeyMaintainersRegistry = getAddressFromTwoKeySingletonRegistry(\"TwoKeyMaintainersRegistry\");\n\n        bool _isMaintainer = ITwoKeyMaintainersRegistry(twoKeyMaintainersRegistry).onlyMaintainer(_maintainer);\n\n        return _isMaintainer;\n",
          "message": "TwoKeyEventSource.isAddressMaintainer (TwoKeyAcquisitionCampaignERC20.sol#468-478) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 483,
          "vulnerability_to_line": 491,
          "vulnerability_code": "    function getTwoKeyDefaultIntegratorFeeFromAdmin()\n\n    public\n\n    view\n\n    returns (uint)\n\n    {\n\n        address twoKeyAdmin = getAddressFromTwoKeySingletonRegistry(\"TwoKeyAdmin\");\n\n        uint integratorFeePercentage = ITwoKeyAdmin(twoKeyAdmin).getDefaultIntegratorFeePercent();\n\n        return integratorFeePercentage;\n",
          "message": "TwoKeyEventSource.getTwoKeyDefaultIntegratorFeeFromAdmin (TwoKeyAcquisitionCampaignERC20.sol#483-491) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 496,
          "vulnerability_to_line": 504,
          "vulnerability_code": "    function getTwoKeyDefaultNetworkTaxPercent()\n\n    public\n\n    view\n\n    returns (uint)\n\n    {\n\n        address twoKeyAdmin = getAddressFromTwoKeySingletonRegistry(\"TwoKeyAdmin\");\n\n        uint networkTaxPercent = ITwoKeyAdmin(twoKeyAdmin).getDefaultNetworkTaxPercent();\n\n        return networkTaxPercent;\n",
          "message": "TwoKeyEventSource.getTwoKeyDefaultNetworkTaxPercent (TwoKeyAcquisitionCampaignERC20.sol#496-504) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 513,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function buyRate2key() public view returns (uint);\n",
          "message": "IUpgradableExchange.buyRate2key (TwoKeyAcquisitionCampaignERC20.sol#513) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 514,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function sellRate2key() public view returns (uint);\n",
          "message": "IUpgradableExchange.sellRate2key (TwoKeyAcquisitionCampaignERC20.sol#514) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 516,
          "vulnerability_to_line": 521,
          "vulnerability_code": "    function buyTokens(\n\n        address _beneficiary\n\n    )\n\n    public\n\n    payable\n",
          "message": "IUpgradableExchange.buyTokens (TwoKeyAcquisitionCampaignERC20.sol#516-521) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 523,
          "vulnerability_to_line": 529,
          "vulnerability_code": "    function buyStableCoinWith2key(\n\n        uint _twoKeyUnits,\n\n        address _beneficiary\n\n    )\n\n    public\n\n    payable\n",
          "message": "IUpgradableExchange.buyStableCoinWith2key (TwoKeyAcquisitionCampaignERC20.sol#523-529) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 564,
          "vulnerability_to_line": 569,
          "vulnerability_code": "    function approve(\n\n        address _spender,\n\n        uint256 _value\n\n    )\n\n    public\n",
          "message": "IERC20.approve (TwoKeyAcquisitionCampaignERC20.sol#564-569) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 659,
          "vulnerability_to_line": 685,
          "vulnerability_code": "    function params0(address c, bytes _method) public view returns (uint answer) {\n\n        // https://medium.com/@blockchain101/calling-the-function-of-another-contract-in-solidity-f9edfa921f4c\n\n        //    dc = c;\n\n        bytes4 sig = bytes4(keccak256(_method));\n\n        assembly {\n\n        // move pointer to free memory spot\n\n            let ptr := mload(0x40)\n\n        // put function sig at memory spot\n\n            mstore(ptr,sig)\n\n\n\n            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n\n            15000, // gas limit\n\n            c, // sload(dc_slot),  // to addr. append var to _slot to access storage variable\n\n            0, // not transfer any ether (comment if using staticcall)\n\n            ptr, // Inputs are stored at location ptr\n\n            0x04, // Inputs are 0 bytes long\n\n            ptr,  //Store output over input\n\n            0x20) //Outputs are 1 bytes long\n\n\n\n            if eq(result, 0) {\n\n                revert(0, 0)\n\n            }\n\n\n\n            answer := mload(ptr) // Assign output to answer var\n\n            mstore(0x40,add(ptr,0x24)) // Set storage pointer to new space\n\n        }\n",
          "message": "Call.params0 (TwoKeyAcquisitionCampaignERC20.sol#659-685) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 687,
          "vulnerability_to_line": 715,
          "vulnerability_code": "    function params1(address c, bytes _method, uint _val) public view returns (uint answer) {\n\n        // https://medium.com/@blockchain101/calling-the-function-of-another-contract-in-solidity-f9edfa921f4c\n\n        //    dc = c;\n\n        bytes4 sig = bytes4(keccak256(_method));\n\n        assembly {\n\n        // move pointer to free memory spot\n\n            let ptr := mload(0x40)\n\n        // put function sig at memory spot\n\n            mstore(ptr,sig)\n\n        // append argument after function sig\n\n            mstore(add(ptr,0x04), _val)\n\n\n\n            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n\n            15000, // gas limit\n\n            c, // sload(dc_slot),  // to addr. append var to _slot to access storage variable\n\n            0, // not transfer any ether (comment if using staticcall)\n\n            ptr, // Inputs are stored at location ptr\n\n            0x24, // Inputs are 0 bytes long\n\n            ptr,  //Store output over input\n\n            0x20) //Outputs are 1 bytes long\n\n\n\n            if eq(result, 0) {\n\n                revert(0, 0)\n\n            }\n\n\n\n            answer := mload(ptr) // Assign output to answer var\n\n            mstore(0x40,add(ptr,0x24)) // Set storage pointer to new space\n\n        }\n",
          "message": "Call.params1 (TwoKeyAcquisitionCampaignERC20.sol#687-715) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 717,
          "vulnerability_to_line": 747,
          "vulnerability_code": "    function params2(address c, bytes _method, uint _val1, uint _val2) public view returns (uint answer) {\n\n        // https://medium.com/@blockchain101/calling-the-function-of-another-contract-in-solidity-f9edfa921f4c\n\n        //    dc = c;\n\n        bytes4 sig = bytes4(keccak256(_method));\n\n        assembly {\n\n        // move pointer to free memory spot\n\n            let ptr := mload(0x40)\n\n        // put function sig at memory spot\n\n            mstore(ptr,sig)\n\n        // append argument after function sig\n\n            mstore(add(ptr,0x04), _val1)\n\n            mstore(add(ptr,0x24), _val2)\n\n\n\n            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n\n            15000, // gas limit\n\n            c, // sload(dc_slot),  // to addr. append var to _slot to access storage variable\n\n            0, // not transfer any ether (comment if using staticcall)\n\n            ptr, // Inputs are stored at location ptr\n\n            0x44, // Inputs are 4 bytes for signature and 2 uint256\n\n            ptr,  //Store output over input\n\n            0x20) //Outputs are 1 uint long\n\n\n\n        // TODO cause revert\n\n        //            if eq(result, 0) {\n\n        //                revert(0, 0)\n\n        //            }\n\n\n\n            answer := mload(ptr) // Assign output to answer var\n\n            mstore(0x40,add(ptr,0x20)) // Set storage pointer to new space\n\n        }\n",
          "message": "Call.params2 (TwoKeyAcquisitionCampaignERC20.sol#717-747) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 889,
          "vulnerability_to_line": 914,
          "vulnerability_code": "    function recoverSig(bytes sig, address old_key, address last_address) public pure returns (address[], address[], uint8[]) {\n\n        // validate sig AND\n\n        // recover the information from the signature: influencers, public_link_keys, weights/cuts\n\n        // influencers may have one more address than the keys and weights arrays\n\n        //\n\n        require(old_key != address(0),'no public link key');\n\n\n\n        address[] memory influencers;\n\n        address[] memory keys;\n\n        uint8[] memory weights;\n\n        uint[] memory offsets;\n\n        (influencers, keys, weights, offsets) = recoverSigParts(sig, last_address);\n\n\n\n        // check if we received a valid signature\n\n        for(uint i = 0; i < influencers.length; i++) {\n\n            if (i < weights.length) {\n\n                require (recoverHash(keccak256(abi.encodePacked(weights[i], keys[i], influencers[i])),sig,offsets[i]) == old_key, 'illegal signature');\n\n                old_key = keys[i];\n\n            } else {\n\n                // signed message for the last step is the address of the converter\n\n                require (recoverHash(keccak256(abi.encodePacked(influencers[i])),sig,offsets[i]) == old_key, 'illegal last signature');\n\n            }\n\n        }\n\n\n\n        return (influencers, keys, weights);\n",
          "message": "Call.recoverSig (TwoKeyAcquisitionCampaignERC20.sol#889-914) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 933,
          "vulnerability_to_line": 935,
          "vulnerability_code": "    function totalSupply() public view returns (uint256) {\n\n        return totalSupply_;\n",
          "message": "ArcERC20.totalSupply (TwoKeyAcquisitionCampaignERC20.sol#933-935) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1114,
          "vulnerability_to_line": 1120,
          "vulnerability_code": "    function setPublicLinkKey(\n\n\t\taddress new_public_key\n\n\t)\n\n\tpublic\n\n\t{\n\n        setPublicLinkKeyOf(msg.sender, new_public_key);\n",
          "message": "TwoKeyCampaign.setPublicLinkKey (TwoKeyAcquisitionCampaignERC20.sol#1114-1120) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1128,
          "vulnerability_to_line": 1140,
          "vulnerability_code": "\tfunction startCampaignWithInitialParams(\n\n\t\tstring _publicMetaHash,\n\n\t\tstring _privateMetaHash,\n\n\t\taddress new_public_key\n\n\t)\n\n\tpublic\n\n\tonlyContractor\n\n\t{\n\n\t\t//TODO: Handle option to update only one of 3 and other setters\n\n\t\tpublicMetaHash = _publicMetaHash;\n\n\t\tprivateMetaHash = _privateMetaHash;\n\n\t\tsetPublicLinkKeyOf(msg.sender, new_public_key);\n",
          "message": "TwoKeyCampaign.startCampaignWithInitialParams (TwoKeyAcquisitionCampaignERC20.sol#1128-1140) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1165,
          "vulnerability_to_line": 1173,
          "vulnerability_code": "\tfunction getReceivedFrom(\n\n\t\taddress _receiver\n\n\t)\n\n\tpublic\n\n\tview\n\n\treturns (address)\n\n\t{\n\n\t\treturn received_from[_receiver];\n",
          "message": "TwoKeyCampaign.getReceivedFrom (TwoKeyAcquisitionCampaignERC20.sol#1165-1173) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1179,
          "vulnerability_to_line": 1187,
          "vulnerability_code": "\tfunction publicLinkKeyOf(\n\n\t\taddress me\n\n\t)\n\n\tpublic\n\n\tview\n\n\treturns (address)\n\n\t{\n\n\t\treturn public_link_key[twoKeyEventSource.plasmaOf(me)];\n",
          "message": "TwoKeyCampaign.publicLinkKeyOf (TwoKeyAcquisitionCampaignERC20.sol#1179-1187) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1192,
          "vulnerability_to_line": 1198,
          "vulnerability_code": "    function getConstantInfo()\n\n\tpublic\n\n\tview\n\n\treturns (uint,uint,bool)\n\n\t{\n\n        return (conversionQuota, maxReferralRewardPercent, isKYCRequired);\n",
          "message": "TwoKeyCampaign.getConstantInfo (TwoKeyAcquisitionCampaignERC20.sol#1192-1198) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1205,
          "vulnerability_to_line": 1211,
          "vulnerability_code": "    function getModeratorTotalEarnings()\n\n\tpublic\n\n\tview\n\n\treturns (uint)\n\n\t{\n\n        return (moderatorTotalEarnings2key);\n",
          "message": "TwoKeyCampaign.getModeratorTotalEarnings (TwoKeyAcquisitionCampaignERC20.sol#1205-1211) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1233,
          "vulnerability_to_line": 1244,
          "vulnerability_code": "    function withdrawContractor()\n\n\tpublic\n\n\tonlyContractor\n\n\t{\n\n        uint balance = contractorBalance;\n\n        contractorBalance = 0;\n\n        /**\n\n         * In general transfer by itself prevents against reentrancy attack since it will throw if more than 2300 gas\n\n         * but however it's not bad to practice this pattern of firstly reducing balance and then doing transfer\n\n         */\n\n        contractor.transfer(balance);\n",
          "message": "TwoKeyCampaign.withdrawContractor (TwoKeyAcquisitionCampaignERC20.sol#1233-1244) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1256,
          "vulnerability_to_line": 1289,
          "vulnerability_code": "\tfunction referrerWithdraw(\n\n\t\taddress _address,\n\n\t\tbool _withdrawAsStable\n\n\t)\n\n\tpublic\n\n\t{\n\n\t\trequire(msg.sender == _address || twoKeyEventSource.isAddressMaintainer(msg.sender));\n\n\t\taddress twoKeyAdminAddress;\n\n\t\taddress twoKeyUpgradableExchangeContract;\n\n\n\n\t\tuint balance;\n\n\t\taddress _referrer = twoKeyEventSource.plasmaOf(_address);\n\n\n\n\t\tif(referrerPlasma2Balances2key[_referrer] != 0) {\n\n\t\t\ttwoKeyAdminAddress = getContractProxyAddress(\"TwoKeyAdmin\");\n\n\t\t\ttwoKeyUpgradableExchangeContract = getContractProxyAddress(\"TwoKeyUpgradableExchange\");\n\n\n\n\t\t\tbalance = referrerPlasma2Balances2key[_referrer];\n\n\t\t\treferrerPlasma2Balances2key[_referrer] = 0;\n\n\n\n\t\t\tif(_withdrawAsStable == true) {\n\n\t\t\t\tIERC20(twoKeyEconomy).approve(twoKeyUpgradableExchangeContract, balance);\n\n\t\t\t\tIUpgradableExchange(twoKeyUpgradableExchangeContract).buyStableCoinWith2key(balance, _address);\n\n\t\t\t}\n\n\t\t\telse if (block.timestamp >= ITwoKeyAdmin(twoKeyAdminAddress).getTwoKeyRewardsReleaseDate()) {\n\n\t\t\t\tIERC20(twoKeyEconomy).transfer(_address, balance);\n\n\t\t\t}\n\n\t\t\telse {\n\n\t\t\t\trevert();\n\n\t\t\t}\n\n\n\n\t\t}\n\n        reservedAmount2keyForRewards -= balance;\n",
          "message": "TwoKeyCampaign.referrerWithdraw (TwoKeyAcquisitionCampaignERC20.sol#1256-1289) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1300,
          "vulnerability_to_line": 1312,
          "vulnerability_code": "    function supportForCreateConversion(\n\n        address _contractor,\n\n        address _converterAddress,\n\n        uint256 _conversionAmount,\n\n        uint256 _maxReferralRewardETHWei,\n\n        uint256 baseTokensForConverterUnits,\n\n        uint256 bonusTokensForConverterUnits,\n\n        bool isConversionFiat,\n\n        bool _isAnonymous,\n\n        bool _isKYCRequired\n\n    )\n\n    public\n",
          "message": "ITwoKeyConversionHandler.supportForCreateConversion (TwoKeyAcquisitionCampaignERC20.sol#1300-1312) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1314,
          "vulnerability_to_line": 1317,
          "vulnerability_code": "    function executeConversion(\n\n        uint _conversionId\n\n    )\n",
          "message": "ITwoKeyConversionHandler.executeConversion (TwoKeyAcquisitionCampaignERC20.sol#1314-1317) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1328,
          "vulnerability_to_line": 1333,
          "vulnerability_code": "    function getConverterPurchasesStats(\n\n        address _converter\n\n    )\n\n    public\n\n    view\n",
          "message": "ITwoKeyConversionHandler.getConverterPurchasesStats (TwoKeyAcquisitionCampaignERC20.sol#1328-1333) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1336,
          "vulnerability_to_line": 1341,
          "vulnerability_code": "    function getStateForConverter(\n\n        address _converter\n\n    )\n\n    public\n\n    view\n",
          "message": "ITwoKeyConversionHandler.getStateForConverter (TwoKeyAcquisitionCampaignERC20.sol#1336-1341) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1354,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function checkIsCampaignActive() public view returns (bool);\n",
          "message": "ITwoKeyAcquisitionLogicHandler.checkIsCampaignActive (TwoKeyAcquisitionCampaignERC20.sol#1354) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1356,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function canConversionBeCreated(address converter, uint amountWillingToSpend, bool isFiat) public view returns (bool);\n",
          "message": "ITwoKeyAcquisitionLogicHandler.canConversionBeCreated (TwoKeyAcquisitionCampaignERC20.sol#1356) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1357,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getEstimatedTokenAmount(uint conversionAmountETHWei, bool isFiatConversion) public view returns (uint, uint);\n",
          "message": "ITwoKeyAcquisitionLogicHandler.getEstimatedTokenAmount (TwoKeyAcquisitionCampaignERC20.sol#1357) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1359,
          "vulnerability_to_line": 1362,
          "vulnerability_code": "    function setTwoKeyAcquisitionCampaignContract(\n\n        address _acquisitionCampaignAddress,\n\n        address twoKeySingletoneRegistry,\n",
          "message": "ITwoKeyAcquisitionLogicHandler.setTwoKeyAcquisitionCampaignContract (TwoKeyAcquisitionCampaignERC20.sol#1359-1362) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1364,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getReferrers(address customer, address acquisitionCampaignContract) public view returns (address[]);\n",
          "message": "ITwoKeyAcquisitionLogicHandler.getReferrers (TwoKeyAcquisitionCampaignERC20.sol#1364) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1365,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function updateRefchainRewards(uint256 _maxReferralRewardETHWei, address _converter, uint _conversionId, uint totalBounty2keys) public;\n",
          "message": "ITwoKeyAcquisitionLogicHandler.updateRefchainRewards (TwoKeyAcquisitionCampaignERC20.sol#1365) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1366,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getReferrerPlasmaTotalEarnings(address _referrer) public view returns (uint);\n",
          "message": "ITwoKeyAcquisitionLogicHandler.getReferrerPlasmaTotalEarnings (TwoKeyAcquisitionCampaignERC20.sol#1366) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1390,
          "vulnerability_to_line": 1392,
          "vulnerability_code": "    function implementation() public view returns (address) {\n\n        return _implementation;\n",
          "message": "UpgradeabilityCampaignStorage.implementation (TwoKeyAcquisitionCampaignERC20.sol#1390-1392) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1451,
          "vulnerability_to_line": 1494,
          "vulnerability_code": "    function setInitialParamsCampaign(\n\n        address _twoKeySingletonesRegistry,\n\n        address _twoKeyAcquisitionLogicHandler,\n\n        address _conversionHandler,\n\n        address _moderator,\n\n        address _assetContractERC20,\n\n        address _contractor,\n\n        uint [] values\n\n    )\n\n    public\n\n    {\n\n        require(isCampaignInitialized == false); // Security layer to make sure the function will act as a constructor\n\n\n\n        contractor = _contractor;\n\n        moderator = _moderator;\n\n\n\n        twoKeySingletonesRegistry = _twoKeySingletonesRegistry;\n\n\n\n        twoKeyEventSource = TwoKeyEventSource(getContractProxyAddress(\"TwoKeyEventSource\"));\n\n        twoKeyEconomy = ITwoKeySingletoneRegistryFetchAddress(_twoKeySingletonesRegistry).getNonUpgradableContractAddress(\"TwoKeyEconomy\");\n\n\n\n        if(values[2] == 1) {\n\n            isKYCRequired = true;\n\n        }\n\n\n\n        if(values[3] == 1) {\n\n            mustConvertToReferr = true;\n\n        }\n\n\n\n        totalSupply_ = 1000000;\n\n\n\n        ownerPlasma = twoKeyEventSource.plasmaOf(contractor);\n\n        received_from[ownerPlasma] = ownerPlasma;\n\n        balances[ownerPlasma] = totalSupply_;\n\n\n\n        maxReferralRewardPercent = values[0];\n\n        conversionQuota = values[1];\n\n\n\n        twoKeyAcquisitionLogicHandler = _twoKeyAcquisitionLogicHandler;\n\n        conversionHandler = _conversionHandler;\n\n        assetContractERC20 = _assetContractERC20;\n\n\n\n        isCampaignInitialized = true;\n",
          "message": "TwoKeyAcquisitionCampaignERC20.setInitialParamsCampaign (TwoKeyAcquisitionCampaignERC20.sol#1451-1494) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1536,
          "vulnerability_to_line": 1542,
          "vulnerability_code": "    function setCut(\n\n        uint256 cut\n\n    )\n\n    public\n\n    {\n\n        setCutOf(msg.sender, cut);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.setCut (TwoKeyAcquisitionCampaignERC20.sol#1536-1542) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1595,
          "vulnerability_to_line": 1604,
          "vulnerability_code": "    function specifyFiatConversionRewards()\n\n    public\n\n    onlyContractor\n\n    payable\n\n    {\n\n        //If you send eth, we ignore argument and create your fiat inventory amount with buying tokens\n\n        if(msg.value > 0) {\n\n            buyTokensFromUpgradableExchange(msg.value, address(this));\n\n        }\n",
          "message": "TwoKeyAcquisitionCampaignERC20.specifyFiatConversionRewards (TwoKeyAcquisitionCampaignERC20.sol#1595-1604) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1612,
          "vulnerability_to_line": 1620,
          "vulnerability_code": "    function joinAndShareARC(\n\n        bytes signature,\n\n        address receiver\n\n    )\n\n    public\n\n    {\n\n        distributeArcsBasedOnSignature(signature, msg.sender);\n\n        transferFrom(twoKeyEventSource.plasmaOf(msg.sender), twoKeyEventSource.plasmaOf(receiver), 1);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.joinAndShareARC (TwoKeyAcquisitionCampaignERC20.sol#1612-1620) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1627,
          "vulnerability_to_line": 1646,
          "vulnerability_code": "    function convert(\n\n        bytes signature,\n\n        bool _isAnonymous\n\n    )\n\n    public\n\n    payable\n\n    {\n\n        bool canConvert = ITwoKeyAcquisitionLogicHandler(twoKeyAcquisitionLogicHandler).canConversionBeCreated(\n\n            msg.sender,\n\n            msg.value,\n\n            false\n\n        );\n\n        require(canConvert == true);\n\n        address _converterPlasma = twoKeyEventSource.plasmaOf(msg.sender);\n\n        if(received_from[_converterPlasma] == address(0)) {\n\n            distributeArcsBasedOnSignature(signature, msg.sender);\n\n        }\n\n        createConversion(msg.value, msg.sender, false, _isAnonymous);\n\n        twoKeyEventSource.converted(address(this),msg.sender,msg.value);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.convert (TwoKeyAcquisitionCampaignERC20.sol#1627-1646) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1655,
          "vulnerability_to_line": 1676,
          "vulnerability_code": "    function convertFiat(\n\n        bytes signature,\n\n        address _converter,\n\n        uint conversionAmountFiatWei,\n\n        bool _isAnonymous\n\n    )\n\n    public\n\n    {\n\n        // Validate that sender is either _converter or maintainer\n\n        require(msg.sender == _converter || twoKeyEventSource.isAddressMaintainer(msg.sender));\n\n        bool canConvert = ITwoKeyAcquisitionLogicHandler(twoKeyAcquisitionLogicHandler).canConversionBeCreated(\n\n            _converter,\n\n            conversionAmountFiatWei,\n\n            true\n\n        );\n\n        require(canConvert == true);\n\n        address _converterPlasma = twoKeyEventSource.plasmaOf(_converter);\n\n        if(received_from[_converterPlasma] == address(0)) {\n\n            distributeArcsBasedOnSignature(signature, _converter);\n\n        }\n\n        createConversion(conversionAmountFiatWei, _converter, true, _isAnonymous);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.convertFiat (TwoKeyAcquisitionCampaignERC20.sol#1655-1676) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1723,
          "vulnerability_to_line": 1755,
          "vulnerability_code": "    function buyTokensAndDistributeReferrerRewards(\n\n        uint256 _maxReferralRewardETHWei,\n\n        address _converter,\n\n        uint _conversionId,\n\n        bool _isConversionFiat\n\n    )\n\n    public\n\n    onlyTwoKeyConversionHandler\n\n    returns (uint)\n\n    {\n\n        //Fiat rewards = fiatamount * moderatorPercentage / 100  / 0.095\n\n        uint totalBounty2keys;\n\n        //If fiat conversion do exactly the same just send different reward and don't buy tokens, take them from contract\n\n        if(maxReferralRewardPercent > 0) {\n\n            if(_isConversionFiat) {\n\n                address upgradableExchange = getContractProxyAddress(\"TwoKeyUpgradableExchange\");\n\n                uint rate = IUpgradableExchange(upgradableExchange).sellRate2key();\n\n                totalBounty2keys = (_maxReferralRewardETHWei / (rate)) * (1000);\n\n                //TODO: add require that there's enough tokens at this moment\n\n            } else {\n\n                //Buy tokens from upgradable exchange\n\n                totalBounty2keys = buyTokensFromUpgradableExchange(_maxReferralRewardETHWei, address(this));\n\n            }\n\n            // Update reserved amount\n\n            //Handle refchain rewards\n\n            ITwoKeyAcquisitionLogicHandler(twoKeyAcquisitionLogicHandler).updateRefchainRewards(\n\n                _maxReferralRewardETHWei,\n\n                _converter,\n\n                _conversionId,\n\n                totalBounty2keys);\n\n        }\n\n        return totalBounty2keys;\n",
          "message": "TwoKeyAcquisitionCampaignERC20.buyTokensAndDistributeReferrerRewards (TwoKeyAcquisitionCampaignERC20.sol#1723-1755) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1762,
          "vulnerability_to_line": 1780,
          "vulnerability_code": "    function buyTokensForModeratorRewards(\n\n        uint moderatorFee\n\n    )\n\n    public\n\n    onlyTwoKeyConversionHandler\n\n    {\n\n        //Get deep freeze token pool address\n\n        address twoKeyDeepFreezeTokenPool = getContractProxyAddress(\"TwoKeyDeepFreezeTokenPool\");\n\n\n\n        uint networkFee = twoKeyEventSource.getTwoKeyDefaultNetworkTaxPercent();\n\n\n\n        // Balance which will go to moderator\n\n        uint balance = moderatorFee.mul(100-networkFee).div(100);\n\n\n\n        uint moderatorEarnings2key = buyTokensFromUpgradableExchange(balance,moderator); // Buy tokens for moderator\n\n        buyTokensFromUpgradableExchange(moderatorFee - balance, twoKeyDeepFreezeTokenPool); // Buy tokens for deep freeze token pool\n\n\n\n        moderatorTotalEarnings2key = moderatorTotalEarnings2key.add(moderatorEarnings2key);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.buyTokensForModeratorRewards (TwoKeyAcquisitionCampaignERC20.sol#1762-1780) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1788,
          "vulnerability_to_line": 1796,
          "vulnerability_code": "    function sendBackEthWhenConversionCancelled(\n\n        address _cancelledConverter,\n\n        uint _conversionAmount\n\n    )\n\n    public\n\n    onlyTwoKeyConversionHandler\n\n    {\n\n        _cancelledConverter.transfer(_conversionAmount);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.sendBackEthWhenConversionCancelled (TwoKeyAcquisitionCampaignERC20.sol#1788-1796) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1804,
          "vulnerability_to_line": 1812,
          "vulnerability_code": "    function moveFungibleAsset(\n\n        address _to,\n\n        uint256 _amount\n\n    )\n\n    public\n\n    onlyTwoKeyConversionHandler\n\n    {\n\n        IERC20(assetContractERC20).transfer(_to, _amount);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.moveFungibleAsset (TwoKeyAcquisitionCampaignERC20.sol#1804-1812) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1820,
          "vulnerability_to_line": 1828,
          "vulnerability_code": "    function updateContractorProceeds(\n\n        uint value\n\n    )\n\n    public\n\n    onlyTwoKeyConversionHandler\n\n    {\n\n        contractorTotalProceeds = contractorTotalProceeds.add(value);\n\n        contractorBalance = contractorBalance.add(value);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.updateContractorProceeds (TwoKeyAcquisitionCampaignERC20.sol#1820-1828) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1834,
          "vulnerability_to_line": 1841,
          "vulnerability_code": "    function updateReservedAmountOfTokensIfConversionRejectedOrExecuted(\n\n        uint value\n\n    )\n\n    public\n\n    onlyTwoKeyConversionHandler\n\n    {\n\n        reservedAmountOfTokens = reservedAmountOfTokens.sub(value);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.updateReservedAmountOfTokensIfConversionRejectedOrExecuted (TwoKeyAcquisitionCampaignERC20.sol#1834-1841) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1848,
          "vulnerability_to_line": 1859,
          "vulnerability_code": "    function getInventoryStatus()\n\n    public\n\n    view\n\n    returns (uint,uint,uint,uint)\n\n    {\n\n        uint inventoryBalance = getTokenBalance(assetContractERC20);\n\n        if(assetContractERC20 == twoKeyEconomy) {\n\n            return (inventoryBalance, reservedAmountOfTokens, reservedAmount2keyForRewards, inventoryBalance);\n\n        } else {\n\n            return (inventoryBalance, reservedAmountOfTokens, reservedAmount2keyForRewards, getTokenBalance(twoKeyEconomy));\n\n        }\n",
          "message": "TwoKeyAcquisitionCampaignERC20.getInventoryStatus (TwoKeyAcquisitionCampaignERC20.sol#1848-1859) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1866,
          "vulnerability_to_line": 1883,
          "vulnerability_code": "    function getReferrerCuts(\n\n        address last_influencer\n\n    )\n\n    public\n\n    view\n\n    returns (uint256[])\n\n    {\n\n        address[] memory influencers = ITwoKeyAcquisitionLogicHandler(twoKeyAcquisitionLogicHandler).getReferrers(last_influencer,address(this));\n\n        uint256[] memory cuts = new uint256[](influencers.length + 1);\n\n\n\n        uint numberOfInfluencers = influencers.length;\n\n        for (uint i = 0; i < numberOfInfluencers; i++) {\n\n            address influencer = influencers[i];\n\n            cuts[i] = getReferrerCut(influencer);\n\n        }\n\n        cuts[influencers.length] = getReferrerCut(last_influencer);\n\n        return cuts;\n",
          "message": "TwoKeyAcquisitionCampaignERC20.getReferrerCuts (TwoKeyAcquisitionCampaignERC20.sol#1866-1883) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1935,
          "vulnerability_to_line": 1944,
          "vulnerability_code": "    function getReferrerPlasmaBalance(\n\n        address _influencer\n\n    )\n\n    public\n\n    view\n\n    returns (uint)\n\n    {\n\n        require(msg.sender == twoKeyAcquisitionLogicHandler);\n\n        return (referrerPlasma2Balances2key[_influencer]);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.getReferrerPlasmaBalance (TwoKeyAcquisitionCampaignERC20.sol#1935-1944) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1951,
          "vulnerability_to_line": 1959,
          "vulnerability_code": "    function updateReferrerPlasmaBalance(\n\n        address _influencer,\n\n        uint _balance\n\n    )\n\n    public\n\n    {\n\n        require(msg.sender == twoKeyAcquisitionLogicHandler);\n\n        referrerPlasma2Balances2key[_influencer] = referrerPlasma2Balances2key[_influencer].add(_balance);\n",
          "message": "TwoKeyAcquisitionCampaignERC20.updateReferrerPlasmaBalance (TwoKeyAcquisitionCampaignERC20.sol#1951-1959) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 1966,
          "vulnerability_to_line": 1977,
          "vulnerability_code": "    function withdrawUnsoldTokens() onlyContractor {\n\n        require(ITwoKeyAcquisitionLogicHandler(twoKeyAcquisitionLogicHandler).checkIsCampaignActive() == false);\n\n        uint unsoldTokens = getAvailableAndNonReservedTokensAmount();\n\n        IERC20(assetContractERC20).transfer(contractor, unsoldTokens);\n\n\n\n        if(assetContractERC20 != twoKeyEconomy) {\n\n            address twoKeyUpgradableExchangeContract = getContractProxyAddress(\"TwoKeyUpgradableExchange\");\n\n            uint rewardsNotSpent = getTokenBalance(twoKeyEconomy) - reservedAmount2keyForRewards;\n\n            IERC20(twoKeyEconomy).approve(twoKeyUpgradableExchangeContract, rewardsNotSpent);\n\n            IUpgradableExchange(twoKeyUpgradableExchangeContract).buyStableCoinWith2key(rewardsNotSpent, msg.sender);\n\n        }\n",
          "message": "TwoKeyAcquisitionCampaignERC20.withdrawUnsoldTokens (TwoKeyAcquisitionCampaignERC20.sol#1966-1977) should be declared external\n"
        },
        {
          "name": "solc-version",
          "vulnerability_from_line": 176,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.0;\n",
          "message": "Detected issues with version pragma in TwoKeyAcquisitionCampaignERC20.sol:\n\t- pragma solidity^0.4.0 (TwoKeyAcquisitionCampaignERC20.sol#176): it allows old versions\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 126,
          "vulnerability_to_line": null,
          "vulnerability_code": "    address internal _implementation;\n",
          "message": "Variable 'UpgradeabilityStorage._implementation' (TwoKeyAcquisitionCampaignERC20.sol#126) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 158,
          "vulnerability_to_line": null,
          "vulnerability_code": "    address public TWO_KEY_SINGLETON_REGISTRY;\n",
          "message": "Variable 'ITwoKeySingletonUtils.TWO_KEY_SINGLETON_REGISTRY' (TwoKeyAcquisitionCampaignERC20.sol#158) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 320,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _twoKeySingletonesRegistry,\n",
          "message": "Parameter '_twoKeySingletonesRegistry' of TwoKeyEventSource.setInitialParams (TwoKeyAcquisitionCampaignERC20.sol#320) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 321,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _proxyStorage\n",
          "message": "Parameter '_proxyStorage' of TwoKeyEventSource.setInitialParams (TwoKeyAcquisitionCampaignERC20.sol#321) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 341,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _campaign,\n",
          "message": "Parameter '_campaign' of TwoKeyEventSource.created (TwoKeyAcquisitionCampaignERC20.sol#341) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 342,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _owner,\n",
          "message": "Parameter '_owner' of TwoKeyEventSource.created (TwoKeyAcquisitionCampaignERC20.sol#342) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 343,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _moderator\n",
          "message": "Parameter '_moderator' of TwoKeyEventSource.created (TwoKeyAcquisitionCampaignERC20.sol#343) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 362,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _campaign,\n",
          "message": "Parameter '_campaign' of TwoKeyEventSource.joined (TwoKeyAcquisitionCampaignERC20.sol#362) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 363,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _from,\n",
          "message": "Parameter '_from' of TwoKeyEventSource.joined (TwoKeyAcquisitionCampaignERC20.sol#363) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 364,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _to\n",
          "message": "Parameter '_to' of TwoKeyEventSource.joined (TwoKeyAcquisitionCampaignERC20.sol#364) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 382,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _campaign,\n",
          "message": "Parameter '_campaign' of TwoKeyEventSource.converted (TwoKeyAcquisitionCampaignERC20.sol#382) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 383,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _converter,\n",
          "message": "Parameter '_converter' of TwoKeyEventSource.converted (TwoKeyAcquisitionCampaignERC20.sol#383) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 384,
          "vulnerability_to_line": null,
          "vulnerability_code": "        uint256 _amountETHWei\n",
          "message": "Parameter '_amountETHWei' of TwoKeyEventSource.converted (TwoKeyAcquisitionCampaignERC20.sol#384) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 401,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _campaign,\n",
          "message": "Parameter '_campaign' of TwoKeyEventSource.rewarded (TwoKeyAcquisitionCampaignERC20.sol#401) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 402,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _to,\n",
          "message": "Parameter '_to' of TwoKeyEventSource.rewarded (TwoKeyAcquisitionCampaignERC20.sol#402) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 403,
          "vulnerability_to_line": null,
          "vulnerability_code": "        uint256 _amount\n",
          "message": "Parameter '_amount' of TwoKeyEventSource.rewarded (TwoKeyAcquisitionCampaignERC20.sol#403) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 418,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address  _campaign,\n",
          "message": "Parameter '_campaign' of TwoKeyEventSource.cancelled (TwoKeyAcquisitionCampaignERC20.sol#418) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 419,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _converter,\n",
          "message": "Parameter '_converter' of TwoKeyEventSource.cancelled (TwoKeyAcquisitionCampaignERC20.sol#419) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 420,
          "vulnerability_to_line": null,
          "vulnerability_code": "        uint256 _indexOrAmount\n",
          "message": "Parameter '_indexOrAmount' of TwoKeyEventSource.cancelled (TwoKeyAcquisitionCampaignERC20.sol#420) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 469,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _maintainer\n",
          "message": "Parameter '_maintainer' of TwoKeyEventSource.isAddressMaintainer (TwoKeyAcquisitionCampaignERC20.sol#469) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 248,
          "vulnerability_to_line": null,
          "vulnerability_code": "    ITwoKeyEventSourceStorage public PROXY_STORAGE_CONTRACT;\n",
          "message": "Variable 'TwoKeyEventSource.PROXY_STORAGE_CONTRACT' (TwoKeyAcquisitionCampaignERC20.sol#248) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 613,
          "vulnerability_to_line": null,
          "vulnerability_code": "  function mul(uint256 _a, uint256 _b) internal pure returns (uint256 c) {\n",
          "message": "Parameter '_a' of SafeMath.mul (TwoKeyAcquisitionCampaignERC20.sol#613) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 613,
          "vulnerability_to_line": null,
          "vulnerability_code": "  function mul(uint256 _a, uint256 _b) internal pure returns (uint256 c) {\n",
          "message": "Parameter '_b' of SafeMath.mul (TwoKeyAcquisitionCampaignERC20.sol#613) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 629,
          "vulnerability_to_line": null,
          "vulnerability_code": "  function div(uint256 _a, uint256 _b) internal pure returns (uint256) {\n",
          "message": "Parameter '_a' of SafeMath.div (TwoKeyAcquisitionCampaignERC20.sol#629) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 629,
          "vulnerability_to_line": null,
          "vulnerability_code": "  function div(uint256 _a, uint256 _b) internal pure returns (uint256) {\n",
          "message": "Parameter '_b' of SafeMath.div (TwoKeyAcquisitionCampaignERC20.sol#629) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 639,
          "vulnerability_to_line": null,
          "vulnerability_code": "  function sub(uint256 _a, uint256 _b) internal pure returns (uint256) {\n",
          "message": "Parameter '_a' of SafeMath.sub (TwoKeyAcquisitionCampaignERC20.sol#639) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 639,
          "vulnerability_to_line": null,
          "vulnerability_code": "  function sub(uint256 _a, uint256 _b) internal pure returns (uint256) {\n",
          "message": "Parameter '_b' of SafeMath.sub (TwoKeyAcquisitionCampaignERC20.sol#639) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 647,
          "vulnerability_to_line": null,
          "vulnerability_code": "  function add(uint256 _a, uint256 _b) internal pure returns (uint256 c) {\n",
          "message": "Parameter '_a' of SafeMath.add (TwoKeyAcquisitionCampaignERC20.sol#647) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 647,
          "vulnerability_to_line": null,
          "vulnerability_code": "  function add(uint256 _a, uint256 _b) internal pure returns (uint256 c) {\n",
          "message": "Parameter '_b' of SafeMath.add (TwoKeyAcquisitionCampaignERC20.sol#647) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 659,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params0(address c, bytes _method) public view returns (uint answer) {\n",
          "message": "Parameter '_method' of Call.params0 (TwoKeyAcquisitionCampaignERC20.sol#659) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 687,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params1(address c, bytes _method, uint _val) public view returns (uint answer) {\n",
          "message": "Parameter '_method' of Call.params1 (TwoKeyAcquisitionCampaignERC20.sol#687) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 717,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params2(address c, bytes _method, uint _val1, uint _val2) public view returns (uint answer) {\n",
          "message": "Parameter '_method' of Call.params2 (TwoKeyAcquisitionCampaignERC20.sol#717) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 822,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigParts(bytes sig, address last_address) private pure returns (address[], address[], uint8[], uint[]) {\n",
          "message": "Parameter 'last_address' of Call.recoverSigParts (TwoKeyAcquisitionCampaignERC20.sol#822) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 889,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSig(bytes sig, address old_key, address last_address) public pure returns (address[], address[], uint8[]) {\n",
          "message": "Parameter 'old_key' of Call.recoverSig (TwoKeyAcquisitionCampaignERC20.sol#889) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 889,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSig(bytes sig, address old_key, address last_address) public pure returns (address[], address[], uint8[]) {\n",
          "message": "Parameter 'last_address' of Call.recoverSig (TwoKeyAcquisitionCampaignERC20.sol#889) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 942,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function balanceOf(address _owner) public view returns (uint256) {\n",
          "message": "Parameter '_owner' of ArcERC20.balanceOf (TwoKeyAcquisitionCampaignERC20.sol#942) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1007,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\taddress _from,\n",
          "message": "Parameter '_from' of TwoKeyCampaign.transferFrom (TwoKeyAcquisitionCampaignERC20.sol#1007) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1008,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\taddress _to,\n",
          "message": "Parameter '_to' of TwoKeyCampaign.transferFrom (TwoKeyAcquisitionCampaignERC20.sol#1008) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1009,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\tuint256 _value\n",
          "message": "Parameter '_value' of TwoKeyCampaign.transferFrom (TwoKeyAcquisitionCampaignERC20.sol#1009) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1038,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\taddress new_public_key\n",
          "message": "Parameter 'new_public_key' of TwoKeyCampaign.setPublicLinkKeyOf (TwoKeyAcquisitionCampaignERC20.sol#1038) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1060,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\taddress _converter\n",
          "message": "Parameter '_converter' of TwoKeyCampaign.getInfluencersKeysAndWeightsFromSignature (TwoKeyAcquisitionCampaignERC20.sol#1060) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1115,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\taddress new_public_key\n",
          "message": "Parameter 'new_public_key' of TwoKeyCampaign.setPublicLinkKey (TwoKeyAcquisitionCampaignERC20.sol#1115) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1129,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\tstring _publicMetaHash,\n",
          "message": "Parameter '_publicMetaHash' of TwoKeyCampaign.startCampaignWithInitialParams (TwoKeyAcquisitionCampaignERC20.sol#1129) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1130,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\tstring _privateMetaHash,\n",
          "message": "Parameter '_privateMetaHash' of TwoKeyCampaign.startCampaignWithInitialParams (TwoKeyAcquisitionCampaignERC20.sol#1130) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1131,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\taddress new_public_key\n",
          "message": "Parameter 'new_public_key' of TwoKeyCampaign.startCampaignWithInitialParams (TwoKeyAcquisitionCampaignERC20.sol#1131) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1166,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\taddress _receiver\n",
          "message": "Parameter '_receiver' of TwoKeyCampaign.getReceivedFrom (TwoKeyAcquisitionCampaignERC20.sol#1166) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1257,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\taddress _address,\n",
          "message": "Parameter '_address' of TwoKeyCampaign.referrerWithdraw (TwoKeyAcquisitionCampaignERC20.sol#1257) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1258,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\tbool _withdrawAsStable\n",
          "message": "Parameter '_withdrawAsStable' of TwoKeyCampaign.referrerWithdraw (TwoKeyAcquisitionCampaignERC20.sol#1258) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 991,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tmapping(address => address) public public_link_key;\n",
          "message": "Variable 'TwoKeyCampaign.public_link_key' (TwoKeyAcquisitionCampaignERC20.sol#991) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 992,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tmapping(address => address) internal received_from; // referral graph, who did you receive the referral from\n",
          "message": "Variable 'TwoKeyCampaign.received_from' (TwoKeyAcquisitionCampaignERC20.sol#992) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1355,
          "vulnerability_to_line": null,
          "vulnerability_code": "    bool public IS_CAMPAIGN_ACTIVE;\n",
          "message": "Variable 'ITwoKeyAcquisitionLogicHandler.IS_CAMPAIGN_ACTIVE' (TwoKeyAcquisitionCampaignERC20.sol#1355) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1384,
          "vulnerability_to_line": null,
          "vulnerability_code": "    address internal _implementation;\n",
          "message": "Variable 'UpgradeabilityCampaignStorage._implementation' (TwoKeyAcquisitionCampaignERC20.sol#1384) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1452,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _twoKeySingletonesRegistry,\n",
          "message": "Parameter '_twoKeySingletonesRegistry' of TwoKeyAcquisitionCampaignERC20.setInitialParamsCampaign (TwoKeyAcquisitionCampaignERC20.sol#1452) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1453,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _twoKeyAcquisitionLogicHandler,\n",
          "message": "Parameter '_twoKeyAcquisitionLogicHandler' of TwoKeyAcquisitionCampaignERC20.setInitialParamsCampaign (TwoKeyAcquisitionCampaignERC20.sol#1453) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1454,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _conversionHandler,\n",
          "message": "Parameter '_conversionHandler' of TwoKeyAcquisitionCampaignERC20.setInitialParamsCampaign (TwoKeyAcquisitionCampaignERC20.sol#1454) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1455,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _moderator,\n",
          "message": "Parameter '_moderator' of TwoKeyAcquisitionCampaignERC20.setInitialParamsCampaign (TwoKeyAcquisitionCampaignERC20.sol#1455) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1456,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _assetContractERC20,\n",
          "message": "Parameter '_assetContractERC20' of TwoKeyAcquisitionCampaignERC20.setInitialParamsCampaign (TwoKeyAcquisitionCampaignERC20.sol#1456) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1457,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _contractor,\n",
          "message": "Parameter '_contractor' of TwoKeyAcquisitionCampaignERC20.setInitialParamsCampaign (TwoKeyAcquisitionCampaignERC20.sol#1457) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1551,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _converter\n",
          "message": "Parameter '_converter' of TwoKeyAcquisitionCampaignERC20.distributeArcsBasedOnSignature (TwoKeyAcquisitionCampaignERC20.sol#1551) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1629,
          "vulnerability_to_line": null,
          "vulnerability_code": "        bool _isAnonymous\n",
          "message": "Parameter '_isAnonymous' of TwoKeyAcquisitionCampaignERC20.convert (TwoKeyAcquisitionCampaignERC20.sol#1629) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1657,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _converter,\n",
          "message": "Parameter '_converter' of TwoKeyAcquisitionCampaignERC20.convertFiat (TwoKeyAcquisitionCampaignERC20.sol#1657) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1659,
          "vulnerability_to_line": null,
          "vulnerability_code": "        bool _isAnonymous\n",
          "message": "Parameter '_isAnonymous' of TwoKeyAcquisitionCampaignERC20.convertFiat (TwoKeyAcquisitionCampaignERC20.sol#1659) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1724,
          "vulnerability_to_line": null,
          "vulnerability_code": "        uint256 _maxReferralRewardETHWei,\n",
          "message": "Parameter '_maxReferralRewardETHWei' of TwoKeyAcquisitionCampaignERC20.buyTokensAndDistributeReferrerRewards (TwoKeyAcquisitionCampaignERC20.sol#1724) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1725,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _converter,\n",
          "message": "Parameter '_converter' of TwoKeyAcquisitionCampaignERC20.buyTokensAndDistributeReferrerRewards (TwoKeyAcquisitionCampaignERC20.sol#1725) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1726,
          "vulnerability_to_line": null,
          "vulnerability_code": "        uint _conversionId,\n",
          "message": "Parameter '_conversionId' of TwoKeyAcquisitionCampaignERC20.buyTokensAndDistributeReferrerRewards (TwoKeyAcquisitionCampaignERC20.sol#1726) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1727,
          "vulnerability_to_line": null,
          "vulnerability_code": "        bool _isConversionFiat\n",
          "message": "Parameter '_isConversionFiat' of TwoKeyAcquisitionCampaignERC20.buyTokensAndDistributeReferrerRewards (TwoKeyAcquisitionCampaignERC20.sol#1727) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1789,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _cancelledConverter,\n",
          "message": "Parameter '_cancelledConverter' of TwoKeyAcquisitionCampaignERC20.sendBackEthWhenConversionCancelled (TwoKeyAcquisitionCampaignERC20.sol#1789) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1790,
          "vulnerability_to_line": null,
          "vulnerability_code": "        uint _conversionAmount\n",
          "message": "Parameter '_conversionAmount' of TwoKeyAcquisitionCampaignERC20.sendBackEthWhenConversionCancelled (TwoKeyAcquisitionCampaignERC20.sol#1790) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1805,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _to,\n",
          "message": "Parameter '_to' of TwoKeyAcquisitionCampaignERC20.moveFungibleAsset (TwoKeyAcquisitionCampaignERC20.sol#1805) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1806,
          "vulnerability_to_line": null,
          "vulnerability_code": "        uint256 _amount\n",
          "message": "Parameter '_amount' of TwoKeyAcquisitionCampaignERC20.moveFungibleAsset (TwoKeyAcquisitionCampaignERC20.sol#1806) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1867,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address last_influencer\n",
          "message": "Parameter 'last_influencer' of TwoKeyAcquisitionCampaignERC20.getReferrerCuts (TwoKeyAcquisitionCampaignERC20.sol#1867) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1936,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _influencer\n",
          "message": "Parameter '_influencer' of TwoKeyAcquisitionCampaignERC20.getReferrerPlasmaBalance (TwoKeyAcquisitionCampaignERC20.sol#1936) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1952,
          "vulnerability_to_line": null,
          "vulnerability_code": "        address _influencer,\n",
          "message": "Parameter '_influencer' of TwoKeyAcquisitionCampaignERC20.updateReferrerPlasmaBalance (TwoKeyAcquisitionCampaignERC20.sol#1952) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 1953,
          "vulnerability_to_line": null,
          "vulnerability_code": "        uint _balance\n",
          "message": "Parameter '_balance' of TwoKeyAcquisitionCampaignERC20.updateReferrerPlasmaBalance (TwoKeyAcquisitionCampaignERC20.sol#1953) is not in mixedCase\n"
        },
        {
          "name": "unused-state",
          "vulnerability_from_line": 1379,
          "vulnerability_to_line": null,
          "vulnerability_code": "    ITwoKeySingletonesRegistry internal registry;\n",
          "message": "UpgradeabilityCampaignStorage.registry (TwoKeyAcquisitionCampaignERC20.sol#1379) is never used in TwoKeyAcquisitionCampaignERC20\nUpgradeabilityCampaignStorage.twoKeyFactory (TwoKeyAcquisitionCampaignERC20.sol#1381) is never used in TwoKeyAcquisitionCampaignERC20\n"
        }
      ]
    },
    "smartcheck": {
      "successfull_analysis": true,
      "errors": [],
      "vulnerability_findings": [
        {
          "name": "SOLIDITY_DIV_MUL",
          "vulnerability_from_line": 1740,
          "vulnerability_to_line": null,
          "vulnerability_code": "                totalBounty2keys = (_maxReferralRewardETHWei / (rate)) * (1000);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
          "vulnerability_from_line": 903,
          "vulnerability_to_line": null,
          "vulnerability_code": "        for(uint i = 0; i < influencers.length; i++) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_EXTRA_GAS_IN_LOOPS",
          "vulnerability_from_line": 848,
          "vulnerability_to_line": null,
          "vulnerability_code": "        while (idx + 65 <= sig.length) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN",
          "vulnerability_from_line": 659,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params0(address c, bytes _method) public view returns (uint answer) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN",
          "vulnerability_from_line": 687,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params1(address c, bytes _method, uint _val) public view returns (uint answer) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_FUNCTIONS_RETURNS_TYPE_AND_NO_RETURN",
          "vulnerability_from_line": 717,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params2(address c, bytes _method, uint _val1, uint _val2) public view returns (uint answer) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
          "vulnerability_from_line": 903,
          "vulnerability_to_line": null,
          "vulnerability_code": "        for(uint i = 0; i < influencers.length; i++) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
          "vulnerability_from_line": 1563,
          "vulnerability_to_line": null,
          "vulnerability_code": "        for (i = 0; i < numberOfInfluencers; i++) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
          "vulnerability_from_line": 1877,
          "vulnerability_to_line": null,
          "vulnerability_code": "        for (uint i = 0; i < numberOfInfluencers; i++) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_GAS_LIMIT_IN_LOOPS",
          "vulnerability_from_line": 848,
          "vulnerability_to_line": null,
          "vulnerability_code": "        while (idx + 65 <= sig.length) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_LOCKED_MONEY",
          "vulnerability_from_line": 141,
          "vulnerability_to_line": null,
          "vulnerability_code": "contract Upgradeable is UpgradeabilityStorage {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_LOCKED_MONEY",
          "vulnerability_from_line": 511,
          "vulnerability_to_line": null,
          "vulnerability_code": "contract IUpgradableExchange {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 3,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 30,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 40,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 54,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 67,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 75,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 115,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 139,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 153,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 176,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.0;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 227,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 235,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 509,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 534,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 601,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 656,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 919,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 950,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 1294,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 1348,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 1371,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 1397,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRAGMAS_VERSION",
          "vulnerability_from_line": 1410,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity ^0.4.24;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_PRIVATE_MODIFIER_DONT_HIDE_DATA",
          "vulnerability_from_line": 1428,
          "vulnerability_to_line": null,
          "vulnerability_code": "    mapping(address => uint256) private referrerPlasma2cut; // Mapping representing how much are cuts in percent(0-100) for referrer address\n",
          "message": null
        },
        {
          "name": "SOLIDITY_REVERT_REQUIRE",
          "vulnerability_from_line": 1280,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\t\telse if (block.timestamp >= ITwoKeyAdmin(twoKeyAdminAddress).getTwoKeyRewardsReleaseDate()) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_SAFEMATH",
          "vulnerability_from_line": 963,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tusing SafeMath for uint256;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_SHOULD_NOT_BE_PURE",
          "vulnerability_from_line": 749,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function loadAddress(bytes sig, uint idx) public pure returns (address) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_SHOULD_NOT_BE_PURE",
          "vulnerability_from_line": 759,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function loadUint8(bytes sig, uint idx) public pure returns (uint8) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_SHOULD_NOT_BE_PURE",
          "vulnerability_from_line": 770,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverHash(bytes32 hash, bytes sig, uint idx) public pure returns (address) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
          "vulnerability_from_line": 659,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params0(address c, bytes _method) public view returns (uint answer) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
          "vulnerability_from_line": 687,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params1(address c, bytes _method, uint _val) public view returns (uint answer) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_SHOULD_NOT_BE_VIEW",
          "vulnerability_from_line": 717,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params2(address c, bytes _method, uint _val1, uint _val2) public view returns (uint answer) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_SHOULD_RETURN_STRUCT",
          "vulnerability_from_line": 807,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigMemory(bytes sig) private pure returns (address[], address[], uint8[], uint[], uint) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_SHOULD_RETURN_STRUCT",
          "vulnerability_from_line": 822,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigParts(bytes sig, address last_address) private pure returns (address[], address[], uint8[], uint[]) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_SHOULD_RETURN_STRUCT",
          "vulnerability_from_line": 1063,
          "vulnerability_to_line": null,
          "vulnerability_code": "\treturns (address[],address[],uint8[],address)\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 13,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getContractsWhereUserIsContractor(address _userAddress) public view returns (address[]);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 14,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getContractsWhereUserIsModerator(address _userAddress) public view returns (address[]);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 15,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getContractsWhereUserIsRefferer(address _userAddress) public view returns (address[]);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 16,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getContractsWhereUserIsConverter(address _userAddress) public view returns (address[]);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 18,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addName(string _name, address _sender, string _fullName, string _email, bytes signature) public;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 18,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addName(string _name, address _sender, string _fullName, string _email, bytes signature) public;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 18,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addName(string _name, address _sender, string _fullName, string _email, bytes signature) public;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 18,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addName(string _name, address _sender, string _fullName, string _email, bytes signature) public;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 19,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addNameByUser(string _name) public;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 20,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getName2Owner(string _name) public view returns (address);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 21,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getOwner2Name(address _sender) public view returns (string);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 48,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function validateAcquisitionCampaign(address campaign, string nonSingletonHash) public;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 49,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function validateDonationCampaign(address campaign, address donationConversionHandler, string nonSingletonHash) public;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 60,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getContractProxyAddress(string _contractName) public view returns (address);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 61,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getNonUpgradableContractAddress(string contractName) public view returns (address);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 62,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getLatestContractVersion(string contractName) public view returns (string);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 62,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getLatestContractVersion(string contractName) public view returns (string);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 102,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addVersion(string _contractName, string version, address implementation) public;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 102,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addVersion(string _contractName, string version, address implementation) public;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 110,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getVersion(string _contractName, string version) public view returns (address);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 110,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getVersion(string _contractName, string version) public view returns (address);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 168,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getAddressFromTwoKeySingletonRegistry(string contractName) internal view returns (address) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 659,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params0(address c, bytes _method) public view returns (uint answer) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 687,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params1(address c, bytes _method, uint _val) public view returns (uint answer) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 717,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params2(address c, bytes _method, uint _val1, uint _val2) public view returns (uint answer) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 749,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function loadAddress(bytes sig, uint idx) public pure returns (address) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 759,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function loadUint8(bytes sig, uint idx) public pure returns (uint8) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 770,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverHash(bytes32 hash, bytes sig, uint idx) public pure returns (address) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 807,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigMemory(bytes sig) private pure returns (address[], address[], uint8[], uint[], uint) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 807,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigMemory(bytes sig) private pure returns (address[], address[], uint8[], uint[], uint) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 807,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigMemory(bytes sig) private pure returns (address[], address[], uint8[], uint[], uint) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 807,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigMemory(bytes sig) private pure returns (address[], address[], uint8[], uint[], uint) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 807,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigMemory(bytes sig) private pure returns (address[], address[], uint8[], uint[], uint) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 822,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigParts(bytes sig, address last_address) private pure returns (address[], address[], uint8[], uint[]) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 822,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigParts(bytes sig, address last_address) private pure returns (address[], address[], uint8[], uint[]) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 822,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigParts(bytes sig, address last_address) private pure returns (address[], address[], uint8[], uint[]) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 822,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigParts(bytes sig, address last_address) private pure returns (address[], address[], uint8[], uint[]) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 822,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSigParts(bytes sig, address last_address) private pure returns (address[], address[], uint8[], uint[]) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 889,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSig(bytes sig, address old_key, address last_address) public pure returns (address[], address[], uint8[]) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 889,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSig(bytes sig, address old_key, address last_address) public pure returns (address[], address[], uint8[]) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 889,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSig(bytes sig, address old_key, address last_address) public pure returns (address[], address[], uint8[]) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 889,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSig(bytes sig, address old_key, address last_address) public pure returns (address[], address[], uint8[]) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1059,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\tbytes sig,\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1063,
          "vulnerability_to_line": null,
          "vulnerability_code": "\treturns (address[],address[],uint8[],address)\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1063,
          "vulnerability_to_line": null,
          "vulnerability_code": "\treturns (address[],address[],uint8[],address)\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1063,
          "vulnerability_to_line": null,
          "vulnerability_code": "\treturns (address[],address[],uint8[],address)\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1129,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\tstring _publicMetaHash,\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1130,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\tstring _privateMetaHash,\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1246,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tfunction getContractProxyAddress(string contractName) internal returns (address) {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1364,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getReferrers(address customer, address acquisitionCampaignContract) public view returns (address[]);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1458,
          "vulnerability_to_line": null,
          "vulnerability_code": "        uint [] values\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1550,
          "vulnerability_to_line": null,
          "vulnerability_code": "        bytes sig,\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1613,
          "vulnerability_to_line": null,
          "vulnerability_code": "        bytes signature,\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1628,
          "vulnerability_to_line": null,
          "vulnerability_code": "        bytes signature,\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1656,
          "vulnerability_to_line": null,
          "vulnerability_code": "        bytes signature,\n",
          "message": null
        },
        {
          "name": "SOLIDITY_UPGRADE_TO_050",
          "vulnerability_from_line": 1871,
          "vulnerability_to_line": null,
          "vulnerability_code": "    returns (uint256[])\n",
          "message": null
        },
        {
          "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
          "vulnerability_from_line": 663,
          "vulnerability_to_line": null,
          "vulnerability_code": "        assembly {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
          "vulnerability_from_line": 691,
          "vulnerability_to_line": null,
          "vulnerability_code": "        assembly {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
          "vulnerability_from_line": 721,
          "vulnerability_to_line": null,
          "vulnerability_code": "        assembly {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
          "vulnerability_from_line": 752,
          "vulnerability_to_line": null,
          "vulnerability_code": "        assembly\n",
          "message": null
        },
        {
          "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
          "vulnerability_from_line": 762,
          "vulnerability_to_line": null,
          "vulnerability_code": "        assembly\n",
          "message": null
        },
        {
          "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
          "vulnerability_from_line": 778,
          "vulnerability_to_line": null,
          "vulnerability_code": "        assembly\n",
          "message": null
        },
        {
          "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
          "vulnerability_from_line": 785,
          "vulnerability_to_line": null,
          "vulnerability_code": "        assembly\n",
          "message": null
        },
        {
          "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
          "vulnerability_from_line": 792,
          "vulnerability_to_line": null,
          "vulnerability_code": "        assembly\n",
          "message": null
        },
        {
          "name": "SOLIDITY_USING_INLINE_ASSEMBLY",
          "vulnerability_from_line": 1086,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\tassembly\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 102,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function addVersion(string _contractName, string version, address implementation) public;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 110,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function getVersion(string _contractName, string version) public view returns (address);\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 1966,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function withdrawUnsoldTokens() onlyContractor {\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 246,
          "vulnerability_to_line": null,
          "vulnerability_code": "    bool initialized;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 966,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tTwoKeyEventSource twoKeyEventSource; // Address of TwoKeyEventSource contract\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 968,
          "vulnerability_to_line": null,
          "vulnerability_code": "\taddress twoKeySingletonesRegistry; // Address of Registry of all singleton contracts\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 969,
          "vulnerability_to_line": null,
          "vulnerability_code": "\taddress twoKeyEconomy; // Address of twoKeyEconomy contract\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 970,
          "vulnerability_to_line": null,
          "vulnerability_code": "\taddress ownerPlasma; //contractor plasma address\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 975,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tbool isKYCRequired;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 976,
          "vulnerability_to_line": null,
          "vulnerability_code": "    bool mustConvertToReferr;\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 978,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tuint256 conversionQuota;  // maximal ARC tokens that can be passed in transferFrom\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 979,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tuint256 contractorBalance; // Contractor balance\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 980,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tuint256 contractorTotalProceeds; // Contractor total earnings\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 981,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tuint256 maxReferralRewardPercent; // maxReferralRewardPercent is actually bonus percentage in ETH\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 982,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tuint256 moderatorTotalEarnings2key; //Total earnings of the moderator all time\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 983,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tuint256 reservedAmount2keyForRewards; //Reserved amount of 2key tokens for rewards distribution\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 1421,
          "vulnerability_to_line": null,
          "vulnerability_code": "    bool isCampaignInitialized; // Once this is set to true can't be modified\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 1426,
          "vulnerability_to_line": null,
          "vulnerability_code": "    address assetContractERC20; // Asset contract is address of ERC20 inventory\n",
          "message": null
        },
        {
          "name": "SOLIDITY_VISIBILITY",
          "vulnerability_from_line": 1430,
          "vulnerability_to_line": null,
          "vulnerability_code": "    uint reservedAmountOfTokens; // Reserved amount of tokens for the converters who are pending approval\n",
          "message": null
        }
      ]
    },
    "oyente": {
      "successfull_analysis": true,
      "errors": [],
      "vulnerability_findings": [
        {
          "name": "Integer Overflow",
          "vulnerability_from_line": 759,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function loadUint8(bytes sig, uint idx) public pure returns (uint8) {\n",
          "message": null
        },
        {
          "name": "Integer Overflow",
          "vulnerability_from_line": 1128,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tfunction startCampaignWithInitialParams(\n",
          "message": null
        },
        {
          "name": "Integer Underflow",
          "vulnerability_from_line": 986,
          "vulnerability_to_line": null,
          "vulnerability_code": "\tstring public publicMetaHash; // Ipfs hash of json campaign object\n",
          "message": null
        }
      ]
    },
    "mythril": {
      "successfull_analysis": true,
      "errors": [],
      "vulnerability_findings": [
        {
          "name": "Integer Arithmetic Bugs (SWC 101)",
          "vulnerability_from_line": 659,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params0(address c, bytes _method) public view returns (uint answer) {\n",
          "message": "The arithmetic operator can overflow.\nIt is possible to cause an integer overflow or underflow in the arithmetic operation. \nClassification: SWC-101"
        },
        {
          "name": "Integer Arithmetic Bugs (SWC 101)",
          "vulnerability_from_line": 687,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params1(address c, bytes _method, uint _val) public view returns (uint answer) {\n",
          "message": "The arithmetic operator can overflow.\nIt is possible to cause an integer overflow or underflow in the arithmetic operation. \nClassification: SWC-101"
        },
        {
          "name": "Integer Arithmetic Bugs (SWC 101)",
          "vulnerability_from_line": 717,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function params2(address c, bytes _method, uint _val1, uint _val2) public view returns (uint answer) {\n",
          "message": "The arithmetic operator can overflow.\nIt is possible to cause an integer overflow or underflow in the arithmetic operation. \nClassification: SWC-101"
        },
        {
          "name": "Integer Arithmetic Bugs (SWC 101)",
          "vulnerability_from_line": 889,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverSig(bytes sig, address old_key, address last_address) public pure returns (address[], address[], uint8[]) {\n",
          "message": "The arithmetic operator can overflow.\nIt is possible to cause an integer overflow or underflow in the arithmetic operation. \nClassification: SWC-101"
        },
        {
          "name": "External Call To User-Supplied Address (SWC 107)",
          "vulnerability_from_line": 669,
          "vulnerability_to_line": null,
          "vulnerability_code": "            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n",
          "message": "A call to a user-supplied address is executed.\nAn external message call to an address specified by the caller is executed. Note that the callee account might contain arbitrary code and could re-enter any function within this contract. Reentering the contract in an intermediate state may lead to unexpected behaviour. Make sure that no state modifications are executed after this call and/or reentrancy guards are in place.\nClassification: SWC-107"
        },
        {
          "name": "External Call To User-Supplied Address (SWC 107)",
          "vulnerability_from_line": 699,
          "vulnerability_to_line": null,
          "vulnerability_code": "            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n",
          "message": "A call to a user-supplied address is executed.\nAn external message call to an address specified by the caller is executed. Note that the callee account might contain arbitrary code and could re-enter any function within this contract. Reentering the contract in an intermediate state may lead to unexpected behaviour. Make sure that no state modifications are executed after this call and/or reentrancy guards are in place.\nClassification: SWC-107"
        },
        {
          "name": "External Call To User-Supplied Address (SWC 107)",
          "vulnerability_from_line": 730,
          "vulnerability_to_line": null,
          "vulnerability_code": "            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n",
          "message": "A call to a user-supplied address is executed.\nAn external message call to an address specified by the caller is executed. Note that the callee account might contain arbitrary code and could re-enter any function within this contract. Reentering the contract in an intermediate state may lead to unexpected behaviour. Make sure that no state modifications are executed after this call and/or reentrancy guards are in place.\nClassification: SWC-107"
        },
        {
          "name": "Unchecked return value from external call. (SWC 104)",
          "vulnerability_from_line": 730,
          "vulnerability_to_line": null,
          "vulnerability_code": "            let result := call(  // use WARNING because this should be staticcall BUT geth crash!\n",
          "message": "The return value of a message call is not checked.\nExternal calls return a boolean value. If the callee halts with an exception, 'false' is returned and execution continues in the caller. The caller should check whether an exception happened and react accordingly to avoid unexpected behavior. For example it is often desirable to wrap external calls in require() so the transaction is reverted if the call fails.\nClassification: SWC-104"
        },
        {
          "name": "Jump to an arbitrary instruction (SWC 127)",
          "vulnerability_from_line": 770,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function recoverHash(bytes32 hash, bytes sig, uint idx) public pure returns (address) {\n",
          "message": "The caller can redirect execution to arbitrary bytecode locations.\nIt is possible to redirect the control flow to arbitrary locations in the code. This may allow an attacker to bypass security controls or manipulate the business logic of the smart contract. Avoid using low-level-operations and assembly to prevent this issue.\nClassification: SWC-127"
        },
        {
          "name": "Exception State (SWC 110)",
          "vulnerability_from_line": 848,
          "vulnerability_to_line": null,
          "vulnerability_code": "        while (idx + 65 <= sig.length) {\n",
          "message": "An assertion violation was triggered.\nIt is possible to trigger an assertion violation. Note that Solidity assert() statements should only be used to check invariants. Review the transaction trace generated for this issue and either make sure your program logic is correct, or use require() instead of assert() if your goal is to constrain user inputs or enforce preconditions. Remember to validate inputs from both callers (for instance, via passed arguments) and callees (for instance, via return values).\nClassification: SWC-110"
        }
      ]
    },
    "osiris": {
      "successfull_analysis": true,
      "errors": [],
      "vulnerability_findings": [
        {
          "name": "Overflow bugs",
          "vulnerability_from_line": 775,
          "vulnerability_to_line": null,
          "vulnerability_code": "        require (sig.length >= 65+idx, 'bad signature length');\n",
          "message": null
        },
        {
          "name": "Underflow bugs",
          "vulnerability_from_line": 810,
          "vulnerability_to_line": null,
          "vulnerability_code": "        uint n_influencers = (sig.length-21) / (65+msg_len);\n",
          "message": null
        },
        {
          "name": "Concurrency bug",
          "vulnerability_from_line": 1156,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\tuint amountBought = IUpgradableExchange(upgradableExchange).buyTokens.value(amountOfMoney)(receiver);\n",
          "message": null
        },
        {
          "name": "Concurrency bug",
          "vulnerability_from_line": 1243,
          "vulnerability_to_line": null,
          "vulnerability_code": "        contractor.transfer(balance);\n",
          "message": null
        },
        {
          "name": "Reentrancy bug",
          "vulnerability_from_line": 1156,
          "vulnerability_to_line": null,
          "vulnerability_code": "\t\tuint amountBought = IUpgradableExchange(upgradableExchange).buyTokens.value(amountOfMoney)(receiver);\n",
          "message": null
        },
        {
          "name": "Reentrancy bug",
          "vulnerability_from_line": 1748,
          "vulnerability_to_line": null,
          "vulnerability_code": "            ITwoKeyAcquisitionLogicHandler(twoKeyAcquisitionLogicHandler).updateRefchainRewards(\n",
          "message": null
        },
        {
          "name": "Underflow bugs",
          "vulnerability_from_line": 1288,
          "vulnerability_to_line": null,
          "vulnerability_code": "        reservedAmount2keyForRewards -= balance;\n",
          "message": null
        },
        {
          "name": "Underflow bugs",
          "vulnerability_from_line": 1910,
          "vulnerability_to_line": null,
          "vulnerability_code": "            return (inventoryBalance - reservedAmountOfTokens - reservedAmount2keyForRewards);\n",
          "message": null
        },
        {
          "name": "Underflow bugs",
          "vulnerability_from_line": 1912,
          "vulnerability_to_line": null,
          "vulnerability_code": "        return (inventoryBalance - reservedAmountOfTokens);\n",
          "message": null
        },
        {
          "name": "Underflow bugs",
          "vulnerability_from_line": 1288,
          "vulnerability_to_line": null,
          "vulnerability_code": "        reservedAmount2keyForRewards -= balance;\n",
          "message": null
        }
      ]
    }
  }
}