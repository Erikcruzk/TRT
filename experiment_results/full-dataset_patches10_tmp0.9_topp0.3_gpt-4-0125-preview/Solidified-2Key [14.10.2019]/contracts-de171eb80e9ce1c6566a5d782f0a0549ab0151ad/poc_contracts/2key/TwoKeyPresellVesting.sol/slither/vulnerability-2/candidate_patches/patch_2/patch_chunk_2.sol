function vestedAmount(ERC20Basic token) public view returns (uint256) {
    uint256 currentBalance = token.balanceOf(address(this));
    uint256 totalBalance = currentBalance.add(released[token]);

    if (block.timestamp < cliff) {
      return 0;
    } else if (block.timestamp >= start.add(duration) || revoked[token]) {
      return totalBalance;
    } else {
      uint256 elapsed = block.timestamp.sub(start);
      uint256 paymentPeriods = elapsed.div(duration.div(numPayments));
      uint256 base = totalBalance.div(1 + bonusPrecentage.div(100));
      uint256 bonus = totalBalance.sub(base);
      return base.add(bonus.mul(paymentPeriods).div(numPayments));
    }
}