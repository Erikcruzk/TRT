function vestedAmount(ERC20Basic token) public view returns (uint256) {
    uint256 currentBalance = token.balanceOf(this);
    uint256 totalBalance = currentBalance.add(released[token]);

    if (now < cliff) {
      return 0;
    } else if (now >= start.add(duration) || revoked[token]) {
      return totalBalance;
    } else {
      uint256 base = totalBalance.div(1 + bonusPrecentage.div(100));
      uint256 bonus = totalBalance.sub(base);
      return base.add(bonus.mul(now.sub(start).mul(numPayments)).div(duration));
    }
}