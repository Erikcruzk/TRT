{
  "smartbugs_completed": true,
  "analyzer_results": {
    "mythril-0.23.15": {
      "successfull_analysis": false,
      "errors": [
        "Solc experienced a fatal error"
      ],
      "vulnerability_findings": []
    },
    "slither": {
      "successfull_analysis": true,
      "errors": [
        "EXIT_CODE_20"
      ],
      "vulnerability_findings": [
        {
          "name": "reentrancy-no-eth",
          "vulnerability_from_line": 67,
          "vulnerability_to_line": 88,
          "vulnerability_code": "    function run() public onlyOwner {\n        if (transfers.length == 0) return;\n\n        uint mNext = next;\n\n        next = transfers.length;\n\n        if ((mNext == 0) && (token.balanceOf(address(this)) != totalToDistribute)) {\n            revert(\"Balance of token contract does not match expected amount\");\n        }\n\n        while ((mNext < transfers.length) && (gasleft() > 150000)) {\n            uint amount = transfers[mNext].amount;\n            address addr = transfers[mNext].addr;\n            if (amount > 0) {\n                require(token.transfer(addr, transfers[mNext].amount), \"Token transfer failed\");\n            }\n            mNext++;\n        }\n\n        next = mNext;",
          "message": "Reentrancy in TokenSender.run (patch_12.sol#67-88):\n\tExternal calls:\n\t- (mNext == 0) && (token.balanceOf(address(this)) != totalToDistribute) (patch_12.sol#74-76)\n\t- require(bool,string)(token.transfer(addr,transfers[mNext].amount),Token transfer failed) (patch_12.sol#82)\n\tState variables written after the call(s):\n\t- next (patch_12.sol#87)\n"
        },
        {
          "name": "calls-loop",
          "vulnerability_from_line": 82,
          "vulnerability_to_line": null,
          "vulnerability_code": "                require(token.transfer(addr, transfers[mNext].amount), \"Token transfer failed\");",
          "message": "TokenSender.run has external calls inside a loop:\n\t- require(bool,string)(token.transfer(addr,transfers[mNext].amount),Token transfer failed) (patch_12.sol#82)\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 15,
          "vulnerability_to_line": 17,
          "vulnerability_code": "    function changeOwner(address _newOwner) public onlyOwner {\n        owner = _newOwner;",
          "message": "Owned.changeOwner (patch_12.sol#15-17) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 19,
          "vulnerability_to_line": 22,
          "vulnerability_code": "    function execute(address _dst, uint _value, bytes memory _data) public onlyOwner {\n        (bool success, ) = _dst.call.value(_value)(_data);\n        require(success, \"Low level call failed\");",
          "message": "Owned.execute (patch_12.sol#19-22) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 26,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function transfer(address, uint) public returns (bool);",
          "message": "Token.transfer (patch_12.sol#26) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 28,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function balanceOf(address) public view returns (uint);",
          "message": "Token.balanceOf (patch_12.sol#28) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 50,
          "vulnerability_to_line": 65,
          "vulnerability_code": "    function fill(uint[] memory data) public onlyOwner {\n        require(next == 0, \"Already filled\");\n        \n        uint acc;\n        uint offset = transfers.length;\n        transfers.length = transfers.length + data.length;\n        for (uint i = 0; i < data.length; i++) {\n            address addr = address(data[i] & (D160 - 1));\n            uint amount = data[i] / D160;\n\n            transfers[offset + i].addr = addr;\n            transfers[offset + i].amount = amount;\n            acc += amount;\n        }\n        totalToDistribute += acc;",
          "message": "TokenSender.fill (patch_12.sol#50-65) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 67,
          "vulnerability_to_line": 88,
          "vulnerability_code": "    function run() public onlyOwner {\n        if (transfers.length == 0) return;\n\n        uint mNext = next;\n\n        next = transfers.length;\n\n        if ((mNext == 0) && (token.balanceOf(address(this)) != totalToDistribute)) {\n            revert(\"Balance of token contract does not match expected amount\");\n        }\n\n        while ((mNext < transfers.length) && (gasleft() > 150000)) {\n            uint amount = transfers[mNext].amount;\n            address addr = transfers[mNext].addr;\n            if (amount > 0) {\n                require(token.transfer(addr, transfers[mNext].amount), \"Token transfer failed\");\n            }\n            mNext++;\n        }\n\n        next = mNext;",
          "message": "TokenSender.run (patch_12.sol#67-88) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 90,
          "vulnerability_to_line": 92,
          "vulnerability_code": "    function hasTerminated() public view returns (bool) {\n        return (transfers.length > 0 && next >= transfers.length);",
          "message": "TokenSender.hasTerminated (patch_12.sol#90-92) should be declared external\n"
        },
        {
          "name": "external-function",
          "vulnerability_from_line": 94,
          "vulnerability_to_line": 96,
          "vulnerability_code": "    function nTransfers() public view returns (uint) {\n        return transfers.length;",
          "message": "TokenSender.nTransfers (patch_12.sol#94-96) should be declared external\n"
        },
        {
          "name": "solc-version",
          "vulnerability_from_line": 1,
          "vulnerability_to_line": null,
          "vulnerability_code": "pragma solidity >=0.4.11;",
          "message": "Detected issues with version pragma in patch_12.sol:\n\t- pragma solidity>=0.4.11 (patch_12.sol#1): it allows old versions\n"
        },
        {
          "name": "low-level-calls",
          "vulnerability_from_line": 19,
          "vulnerability_to_line": 22,
          "vulnerability_code": "    function execute(address _dst, uint _value, bytes memory _data) public onlyOwner {\n        (bool success, ) = _dst.call.value(_value)(_data);\n        require(success, \"Low level call failed\");",
          "message": "Low level call in Owned.execute (patch_12.sol#19-22):\n\t-(success) = _dst.call.value(_value)(_data) patch_12.sol#20\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 15,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function changeOwner(address _newOwner) public onlyOwner {",
          "message": "Parameter '_newOwner' of Owned.changeOwner (patch_12.sol#15) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 19,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function execute(address _dst, uint _value, bytes memory _data) public onlyOwner {",
          "message": "Parameter '_dst' of Owned.execute (patch_12.sol#19) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 19,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function execute(address _dst, uint _value, bytes memory _data) public onlyOwner {",
          "message": "Parameter '_value' of Owned.execute (patch_12.sol#19) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 19,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function execute(address _dst, uint _value, bytes memory _data) public onlyOwner {",
          "message": "Parameter '_data' of Owned.execute (patch_12.sol#19) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 26,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function transfer(address, uint) public returns (bool);",
          "message": "Parameter '' of Token.transfer (patch_12.sol#26) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 26,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function transfer(address, uint) public returns (bool);",
          "message": "Parameter '_scope_0' of Token.transfer (patch_12.sol#26) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 28,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function balanceOf(address) public view returns (uint);",
          "message": "Parameter '' of Token.balanceOf (patch_12.sol#28) is not in mixedCase\n"
        },
        {
          "name": "naming-convention",
          "vulnerability_from_line": 44,
          "vulnerability_to_line": null,
          "vulnerability_code": "    constructor(address _token) public {",
          "message": "Parameter '_token' of TokenSender. (patch_12.sol#44) is not in mixedCase\n"
        }
      ]
    },
    "oyente": {
      "successfull_analysis": true,
      "errors": [],
      "vulnerability_findings": [
        {
          "name": "Callstack Depth Attack Vulnerability",
          "vulnerability_from_line": 20,
          "vulnerability_to_line": null,
          "vulnerability_code": "        (bool success, ) = _dst.call.value(_value)(_data);",
          "message": null
        },
        {
          "name": "Integer Overflow",
          "vulnerability_from_line": 19,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function execute(address _dst, uint _value, bytes memory _data) public onlyOwner {",
          "message": null
        },
        {
          "name": "Callstack Depth Attack Vulnerability",
          "vulnerability_from_line": 20,
          "vulnerability_to_line": null,
          "vulnerability_code": "        (bool success, ) = _dst.call.value(_value)(_data);",
          "message": null
        },
        {
          "name": "Integer Overflow",
          "vulnerability_from_line": 50,
          "vulnerability_to_line": null,
          "vulnerability_code": "    function fill(uint[] memory data) public onlyOwner {",
          "message": null
        }
      ]
    }
  }
}